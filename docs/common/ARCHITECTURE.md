# ì´ë²¤íŠ¸ íŠ¸ë˜í‚¹ ë°ì´í„° ìƒì„±ê¸° - ì•„í‚¤í…ì²˜ ë¬¸ì„œ

## ê°œìš”

AI ê¸°ë°˜ìœ¼ë¡œ Excel í…ì†Œë…¸ë¯¸ ìŠ¤í‚¤ë§ˆë¥¼ ìƒì„±í•˜ê±°ë‚˜ ê¸°ì¡´ Excel íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì—¬ í˜„ì‹¤ì ì¸ ì„œë¹„ìŠ¤ ì´ë²¤íŠ¸ ë°ì´í„°ë¥¼ ìƒì„±í•˜ê³  LogBus2ë¡œ ThinkingEngineì— ì „ì†¡í•˜ëŠ” ì—”í„°í”„ë¼ì´ì¦ˆê¸‰ í†µí•© ì‹œìŠ¤í…œì…ë‹ˆë‹¤.

**í•µì‹¬ íŠ¹ì§•**:
- **ì—”í„°í”„ë¼ì´ì¦ˆ ì¸ì¦ ì‹œìŠ¤í…œ**: JWT ê¸°ë°˜ ì¸ì¦, ì—­í•  ê¸°ë°˜ ì ‘ê·¼ ì œì–´ (RBAC: Admin/User/Viewer)
- **PostgreSQL ë°ì´í„°ë² ì´ìŠ¤**: ì‚¬ìš©ì ê´€ë¦¬, ì„¤ì • ì €ì¥, ê°ì‚¬ ë¡œê·¸, ì‹¤í–‰ ê¸°ë¡
- **Multi-User ì§€ì›**: ì‚¬ìš©ìë³„ AI API Key ë° ì„¤ì • ê´€ë¦¬
- **ë‘ ê°€ì§€ ì‹œì‘ ëª¨ë“œ**: Excel ìë™ ìƒì„± ë˜ëŠ” ê¸°ì¡´ íŒŒì¼ ì—…ë¡œë“œ
- **AI 3ë‹¨ê³„ í…ì†Œë…¸ë¯¸ ìƒì„±**: ì„œë¹„ìŠ¤ ì •ë³´ë§Œìœ¼ë¡œ 4-sheet Excel ìŠ¤í‚¤ë§ˆ ìë™ ìƒì„±
  - Stage 1: ì´ë²¤íŠ¸/ì†ì„± ì„¤ê³„
  - Stage 2: ë°ì´í„° êµ¬ì¡° ìµœì í™”
  - Stage 3: 4-sheet Excel ìƒì„± (#ìœ ì € ID ì²´ê³„, #ì´ë²¤íŠ¸ ë°ì´í„°, #ê³µí†µ ì†ì„±, #ìœ ì € ë°ì´í„°)
- **Multi-Provider AI ì§€ì›**: Anthropic Claude / OpenAI GPT / Google Gemini
  - Excel ìƒì„±ê³¼ ë°ì´í„° ìƒì„±ì— ê°ê° ë‹¤ë¥¸ Provider ì‚¬ìš© ê°€ëŠ¥
  - ì‚¬ìš©ìë³„ ì„¤ì • UIì—ì„œ ê°„í¸í•˜ê²Œ ë³€ê²½ ê°€ëŠ¥
  - ê²€ì¦ ëª¨ë¸ ë“±ê¸‰ ì„ íƒ (Fast/Balanced)
- **ìœ ì € ìƒëª…ì£¼ê¸° ê¸°ë°˜**: í˜„ì‹¤ì ì¸ ì´ë²¤íŠ¸ ìƒì„± (Faker.js í†µí•©, êµ­ê°€ë³„ ë¡œì¼€ì¼ ì§€ì›)
- **ì¼ìë³„ JSONL ë¶„ë¦¬**: ë‚ ì§œë³„ íŒŒì¼ë¡œ ë¶„ë¦¬ ì €ì¥
- **LogBus2 í†µí•©**: Gzip ì••ì¶• ì „ì†¡ìœ¼ë¡œ ìµœì í™”
- **Excel ë‹¤ìš´ë¡œë“œ**: ìƒì„±ëœ ìŠ¤í‚¤ë§ˆ íŒŒì¼ ë‹¤ìš´ë¡œë“œ ê°€ëŠ¥
- **ì‹¤ì‹œê°„ ì§„í–‰ ìƒíƒœ**: ë°ì´í„° ìƒì„± ë° ì „ì†¡ ì§„í–‰ë¥  ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§
- **ëŒ€ì‹œë³´ë“œ UI**: Next.js 14 ê¸°ë°˜ ëª¨ë˜ ëŒ€ì‹œë³´ë“œ (ë‹¤êµ­ì–´ ì§€ì›: í•œ/ì˜/ì¤‘)
- **ê°ì‚¬ ë¡œê·¸**: ëª¨ë“  ì¤‘ìš” ì‘ì—… ê¸°ë¡ (Admin ì „ìš©)
- **íŒŒì¼ ê´€ë¦¬**: ìë™ ì •ë¦¬, ë³´ê´€ ê¸°ê°„ ì„¤ì •, ë‹¤ìš´ë¡œë“œ

## ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

### ì „ì²´ íë¦„ë„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              í”„ë¡ íŠ¸ì—”ë“œ (Next.js 14 App Router)                  â”‚
â”‚                      http://localhost:3000                       â”‚
â”‚                                                                  â”‚
â”‚  [ğŸ” ë¡œê·¸ì¸ í˜ì´ì§€] /login                                       â”‚
â”‚         â”‚                                                        â”‚
â”‚         â–¼                                                        â”‚
â”‚  [ğŸ“Š ëŒ€ì‹œë³´ë“œ] /dashboard                                       â”‚
â”‚    â”œâ”€ í™ˆ (Quick Launch, íŒŒì¼ ê´€ë¦¬, ê³µì§€ì‚¬í•­)                   â”‚
â”‚    â”œâ”€ ë°ì´í„° ìƒì„±ê¸° (/dashboard/generator)                     â”‚
â”‚    â”‚   â”œâ”€ Excel ìƒì„± ë˜ëŠ” ì—…ë¡œë“œ                                â”‚
â”‚    â”‚   â”œâ”€ ë°ì´í„° ìƒì„±                                           â”‚
â”‚    â”‚   â””â”€ ThinkingEngine ì „ì†¡                                  â”‚
â”‚    â”œâ”€ ì‚¬ìš©ì ê´€ë¦¬ (/dashboard/users) - Admin ì „ìš©              â”‚
â”‚    â”œâ”€ ê°ì‚¬ ë¡œê·¸ (/dashboard/audit) - Admin ì „ìš©                â”‚
â”‚    â””â”€ ì„¤ì • (/dashboard/settings)                               â”‚
â”‚        â”œâ”€ AI API Keys (ì‚¬ìš©ìë³„)                                â”‚
â”‚        â”œâ”€ ThinkingEngine ì„¤ì •                                   â”‚
â”‚        â””â”€ íŒŒì¼ ë³´ê´€ ì •ì±…                                        â”‚
â”‚                                                                  â”‚
â”‚  ë‹¤êµ­ì–´ ì§€ì›: í•œêµ­ì–´ / English / ä¸­æ–‡                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  API ì„œë²„ (Express + TypeScript)                 â”‚
â”‚                     http://localhost:3001                        â”‚
â”‚                                                                  â”‚
â”‚  ì¸ì¦ & ì‚¬ìš©ì ê´€ë¦¬:                                             â”‚
â”‚  â€¢ POST /api/auth/login                ì‚¬ìš©ì ë¡œê·¸ì¸ (JWT)     â”‚
â”‚  â€¢ GET  /api/auth/me                   í˜„ì¬ ì‚¬ìš©ì ì •ë³´         â”‚
â”‚  â€¢ POST /api/auth/logout               ë¡œê·¸ì•„ì›ƒ                 â”‚
â”‚  â€¢ GET  /api/users                     ì‚¬ìš©ì ëª©ë¡ (Admin)      â”‚
â”‚  â€¢ POST /api/users                     ì‚¬ìš©ì ìƒì„± (Admin)      â”‚
â”‚  â€¢ PUT  /api/users/:id                 ì‚¬ìš©ì ìˆ˜ì • (Admin)      â”‚
â”‚  â€¢ DELETE /api/users/:id               ì‚¬ìš©ì ì‚­ì œ (Admin)      â”‚
â”‚  â€¢ PUT  /api/users/profile             í”„ë¡œí•„ ìˆ˜ì •              â”‚
â”‚                                                                  â”‚
â”‚  ì„¤ì • ê´€ë¦¬ (ì‚¬ìš©ìë³„):                                           â”‚
â”‚  â€¢ GET  /api/settings                  ì‚¬ìš©ì ì„¤ì • ì¡°íšŒ         â”‚
â”‚  â€¢ POST /api/settings                  ì‚¬ìš©ì ì„¤ì • ì €ì¥         â”‚
â”‚                                                                  â”‚
â”‚  Excel ê´€ë¦¬:                                                     â”‚
â”‚  â€¢ POST /api/excel/generate            AI Excel ìŠ¤í‚¤ë§ˆ ìƒì„±    â”‚
â”‚  â€¢ GET  /api/excel/list                Excel íŒŒì¼ ëª©ë¡          â”‚
â”‚  â€¢ GET  /api/excel/download/:filename  Excel ë‹¤ìš´ë¡œë“œ          â”‚
â”‚  â€¢ POST /api/excel/upload              Excel ì—…ë¡œë“œ ë° íŒŒì‹±    â”‚
â”‚  â€¢ DELETE /api/excel/:filename         Excel íŒŒì¼ ì‚­ì œ          â”‚
â”‚  â€¢ PUT  /api/excel/:filename/retention ë³´ê´€ ê¸°ê°„ ì—°ì¥           â”‚
â”‚                                                                  â”‚
â”‚  ë°ì´í„° ìƒì„±:                                                    â”‚
â”‚  â€¢ POST /api/generate/start            ë°ì´í„° ìƒì„± ì‹œì‘ (ë¹„ë™ê¸°)â”‚
â”‚  â€¢ GET  /api/generate/status/:runId    ì§„í–‰ ìƒíƒœ í´ë§          â”‚
â”‚  â€¢ POST /api/generate/analysis-excel   AI ë¶„ì„ ê²°ê³¼ Excel ìƒì„± â”‚
â”‚                                                                  â”‚
â”‚  ì‹¤í–‰ ê¸°ë¡ ê´€ë¦¬:                                                 â”‚
â”‚  â€¢ GET  /api/runs/list                 ì‹¤í–‰ ëª©ë¡ ì¡°íšŒ           â”‚
â”‚  â€¢ GET  /api/runs/:runId               ì‹¤í–‰ ìƒì„¸ ì¡°íšŒ           â”‚
â”‚  â€¢ DELETE /api/runs/:runId             ì‹¤í–‰ ë°ì´í„° ì‚­ì œ         â”‚
â”‚  â€¢ PUT  /api/runs/:runId/retention     ë³´ê´€ ê¸°ê°„ ì—°ì¥           â”‚
â”‚                                                                  â”‚
â”‚  ë°ì´í„° ì „ì†¡:                                                    â”‚
â”‚  â€¢ POST /api/send-data/:runId          ThinkingEngine ì „ì†¡     â”‚
â”‚                                                                  â”‚
â”‚  íŒŒì¼ ê´€ë¦¬:                                                      â”‚
â”‚  â€¢ GET  /api/files/list                íŒŒì¼ ëª©ë¡ (ë°ì´í„°+Excel) â”‚
â”‚                                                                  â”‚
â”‚  ê°ì‚¬ ë¡œê·¸ (Admin ì „ìš©):                                         â”‚
â”‚  â€¢ GET  /api/audit-logs                ê°ì‚¬ ë¡œê·¸ ì¡°íšŒ           â”‚
â”‚                                                                  â”‚
â”‚  LogBus2 ëª¨ë‹ˆí„°ë§:                                               â”‚
â”‚  â€¢ GET  /api/logbus/status             LogBus2 ìƒíƒœ             â”‚
â”‚  â€¢ GET  /api/logbus/logs               ì‹¤ì‹œê°„ ë¡œê·¸ ìŠ¤íŠ¸ë¦¬ë°     â”‚
â”‚                                                                  â”‚
â”‚  ë¯¸ë“¤ì›¨ì–´:                                                       â”‚
â”‚  â€¢ requireAuth                         JWT í† í° ê²€ì¦            â”‚
â”‚  â€¢ requireAdmin                        Admin ê¶Œí•œ í™•ì¸          â”‚
â”‚  â€¢ auditMiddleware                     ê°ì‚¬ ë¡œê·¸ ìë™ ê¸°ë¡      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PostgreSQL ë°ì´í„°ë² ì´ìŠ¤                       â”‚
â”‚                                                                  â”‚
â”‚  í…Œì´ë¸”:                                                         â”‚
â”‚  â€¢ users              ì‚¬ìš©ì ì •ë³´ (username, email, role)       â”‚
â”‚  â€¢ user_settings      ì‚¬ìš©ìë³„ ì„¤ì • (API Keys, AI Provider)     â”‚
â”‚  â€¢ runs               ì‹¤í–‰ ê¸°ë¡                                  â”‚
â”‚  â€¢ audit_logs         ê°ì‚¬ ë¡œê·¸ (ëª¨ë“  ì‘ì—… ì¶”ì )                â”‚
â”‚  â€¢ excel_uploads      ì—…ë¡œë“œëœ Excel íŒŒì¼ ì¶”ì                   â”‚
â”‚  â€¢ sessions           ì„¸ì…˜ ê´€ë¦¬ (ì„ íƒì )                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ë°ì´í„° ìƒì„± ì—”ì§„                              â”‚
â”‚                                                                  â”‚
â”‚  1. Excel íŒŒì‹± â†’ 4-sheet ìŠ¤í‚¤ë§ˆ ì¶”ì¶œ                            â”‚
â”‚     (#ìœ ì € ID ì²´ê³„, #ì´ë²¤íŠ¸ ë°ì´í„°, #ê³µí†µ ì†ì„±, #ìœ ì € ë°ì´í„°)   â”‚
â”‚  2. AI ë¶„ì„ (Anthropic/OpenAI) â†’ ì´ë²¤íŠ¸ ì˜ì¡´ì„±, ë°ì´í„° ë²”ìœ„    â”‚
â”‚  3. ìœ ì € ì½”í˜¸íŠ¸ ìƒì„± â†’ Faker.js êµ­ê°€ë³„ í˜„ì‹¤ ë°ì´í„°              â”‚
â”‚  4. ì¼ìë³„ ì´ë²¤íŠ¸ ìƒì„± â†’ ì˜ì¡´ì„± ê²€ì¦ â†’ JSONL íŒŒì¼ ì €ì¥         â”‚
â”‚  5. ì§„í–‰ ìƒíƒœ ì½œë°± (onProgress) â†’ API ì„œë²„ â†’ í”„ë¡ íŠ¸ì—”ë“œ        â”‚
â”‚                                                                  â”‚
â”‚  ì¶œë ¥: output/data/run_XXX/*.jsonl (ë‚ ì§œë³„ ë¶„ë¦¬)                â”‚
â”‚        output/runs/run_XXX/metadata.json (ì‹¤í–‰ ì •ë³´)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    LogBus2 í†µí•© ë ˆì´ì–´                           â”‚
â”‚                                                                  â”‚
â”‚  1. daemon.json ìë™ ìƒì„± (gzip ì••ì¶• ì„¤ì •)                      â”‚
â”‚  2. LogBus2 í”„ë¡œì„¸ìŠ¤ ì‹œì‘                                        â”‚
â”‚  3. ë‚ ì§œìˆœ íŒŒì¼ ì „ì†¡ (2025-01-01.jsonl â†’ 01-02 â†’ ...)          â”‚
â”‚  4. ì§„í–‰ ìƒíƒœ ëª¨ë‹ˆí„°ë§ (ì—…ë¡œë“œ íŒŒì¼ ìˆ˜/ì „ì²´ íŒŒì¼)               â”‚
â”‚  5. ì „ì†¡ ì™„ë£Œ í›„ LogBus2 ì¢…ë£Œ                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               ThinkingEngine Receiver                            â”‚
â”‚         https://te-receiver-naver.thinkingdata.kr/               â”‚
â”‚                                                                  â”‚
â”‚  â€¢ Gzip ì••ì¶• ë°ì´í„° ìˆ˜ì‹                                          â”‚
â”‚  â€¢ ì´ë²¤íŠ¸ ì €ì¥ ë° ë¶„ì„                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ì‚¬ìš©ì íë¦„

#### 1. ë¡œê·¸ì¸ ë° ì´ˆê¸° ì„¤ì •

```
[ë¡œê·¸ì¸ í˜ì´ì§€] /login
   â†“
ì‚¬ìš©ìëª…/ë¹„ë°€ë²ˆí˜¸ ì…ë ¥
   â†“
JWT í† í° ë°œê¸‰ (7ì¼ ìœ íš¨)
   â†“
[ëŒ€ì‹œë³´ë“œ í™ˆ] /dashboard
   â†“
[ì„¤ì •] /dashboard/settings
   â†“
AI API Keys ë“±ë¡:
  - Anthropic API Key
  - OpenAI API Key
  - Gemini API Key
  - Excel AI Provider ì„ íƒ
  - Data AI Provider ì„ íƒ
  - Validation Model Tier ì„ íƒ
   â†“
ThinkingEngine ì„¤ì •:
  - TE App ID
  - TE Receiver URL
   â†“
íŒŒì¼ ë³´ê´€ ì •ì±…:
  - ë°ì´í„° íŒŒì¼ ë³´ê´€ ê¸°ê°„ (ê¸°ë³¸ 7ì¼)
  - Excel íŒŒì¼ ë³´ê´€ ê¸°ê°„ (ê¸°ë³¸ 30ì¼)
  - ì „ì†¡ í›„ ì¦‰ì‹œ ì‚­ì œ ì—¬ë¶€
```

#### 2. ë°ì´í„° ìƒì„± íë¦„ (í†µí•©)

```
[ëŒ€ì‹œë³´ë“œ í™ˆ] â†’ [ë°ì´í„° ìƒì„±ê¸°] /dashboard/generator
   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Excel ìŠ¤í‚¤ë§ˆ ì„ íƒ                    â”‚
â”‚  â‘  ìƒˆë¡œ ë§Œë“¤ê¸° (AI ìƒì„±)            â”‚
â”‚  â‘¡ ê¸°ì¡´ Excel ì—…ë¡œë“œ                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â†“
[â‘  ìƒˆë¡œ ë§Œë“¤ê¸° ì„ íƒ ì‹œ]
   â†“
ì„œë¹„ìŠ¤ ì •ë³´ ì…ë ¥:
  - ì‹œë‚˜ë¦¬ì˜¤
  - ì‚°ì—…
  - ì„œë¹„ìŠ¤ íŠ¹ì§•
  - (ì„ íƒ) ì°¸ê³  íŒŒì¼ ì—…ë¡œë“œ â†’ AI ì»¨í…ìŠ¤íŠ¸ ì¶”ê°€
   â†“
POST /api/excel/generate
   â†“
AI 3ë‹¨ê³„ ìƒì„± (ì‚¬ìš©ì ì„¤ì •ëœ Provider ì‚¬ìš©):
  - Stage 1: ì´ë²¤íŠ¸/ì†ì„± ì„¤ê³„
  - Stage 2: ë°ì´í„° êµ¬ì¡° ìµœì í™”
  - Stage 3: 4-sheet Excel ìƒì„±
   â†“
Excel ë¯¸ë¦¬ë³´ê¸° í‘œì‹œ
   â†“
[â‘¡ ê¸°ì¡´ Excel ì—…ë¡œë“œ ì„ íƒ ì‹œ]
   â†“
íŒŒì¼ ë“œë˜ê·¸ ì•¤ ë“œë¡­ ë˜ëŠ” ì„ íƒ
   â†“
POST /api/excel/upload
   â†“
ì„œë²„ì—ì„œ ìë™ íŒŒì‹± ë° ê²€ì¦
   â†“
Excel ë¯¸ë¦¬ë³´ê¸° í‘œì‹œ
   â†“
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[ê³µí†µ: ë°ì´í„° ìƒì„± ì„¤ì •]
   â†“
ì…ë ¥:
  - DAU (Daily Active Users)
  - ì‹œì‘ ë‚ ì§œ
  - ì¢…ë£Œ ë‚ ì§œ
  - ì‹œë‚˜ë¦¬ì˜¤ (â‘¡ ê²½ìš°)
  - ì‚°ì—… (â‘¡ ê²½ìš°)
  - ì„œë¹„ìŠ¤ íŠ¹ì§• (â‘¡ ê²½ìš°)
  - (ì„ íƒ) ì°¸ê³  íŒŒì¼ ì—…ë¡œë“œ
   â†“
POST /api/generate/start
   â†“
ë¹„ë™ê¸° ë°ì´í„° ìƒì„± ì‹œì‘:
  1. Excel íŒŒì‹± (5%)
  2. AI ë°ì´í„° ë²”ìœ„ ë¶„ì„ (15%)
  3. AI ê²€ì¦ íŒŒì´í”„ë¼ì¸ ì‹¤í–‰ (25%)
  4. ìœ ì € ì½”í˜¸íŠ¸ ìƒì„± (35%)
  5. ì¼ìë³„ ì´ë²¤íŠ¸ ìƒì„± (50-95%)
  6. JSONL íŒŒì¼ ì €ì¥ (100%)
   â†“
ì§„í–‰ ìƒí™© í´ë§ (2ì´ˆë§ˆë‹¤):
  GET /api/generate/status/:runId
   â†“
[ìƒì„± ì™„ë£Œ]
   â†“
ê²°ê³¼ í‘œì‹œ:
  - ì´ ì´ë²¤íŠ¸ ìˆ˜
  - ì´ ì‚¬ìš©ì ìˆ˜
  - ì´ ì¼ìˆ˜
  - Run ID
  - AI ë¶„ì„ ê²°ê³¼ Excel ë‹¤ìš´ë¡œë“œ (ì„ íƒ)
   â†“
[ThinkingEngine ì „ì†¡]
   â†“
APP_ID ì…ë ¥ (ë˜ëŠ” ì„¤ì •ì—ì„œ ê¸°ë³¸ê°’ ì‚¬ìš©)
   â†“
POST /api/send-data/:runId
   â†“
LogBus2 ì œì–´:
  1. daemon.json ìƒì„±
  2. LogBus2 start
  3. ì§„í–‰ ìƒí™© ëª¨ë‹ˆí„°ë§ (3ì´ˆ í´ë§)
  4. LogBus2 stop
   â†“
ì „ì†¡ ì™„ë£Œ
   â†“
ê°ì‚¬ ë¡œê·¸ ê¸°ë¡:
  - ì‚¬ìš©ì: {username}
  - ì‘ì—…: send_data
  - RunID: {runId}
  - ìƒíƒœ: success
   â†“
[ì„ íƒì ] ìë™ íŒŒì¼ ì‚­ì œ
  (AUTO_DELETE_AFTER_SEND=true ì‹œ)
```

#### 3. Admin ì „ìš© ê¸°ëŠ¥

```
[ì‚¬ìš©ì ê´€ë¦¬] /dashboard/users
   â†“
ì‚¬ìš©ì ëª©ë¡ ì¡°íšŒ:
  GET /api/users
   â†“
ì‚¬ìš©ì ìƒì„±:
  POST /api/users
  - username, email, password, role
   â†“
ì‚¬ìš©ì ìˆ˜ì •:
  PUT /api/users/:id
   â†“
ì‚¬ìš©ì ì‚­ì œ:
  DELETE /api/users/:id
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[ê°ì‚¬ ë¡œê·¸] /dashboard/audit
   â†“
ê°ì‚¬ ë¡œê·¸ ì¡°íšŒ ë° í•„í„°ë§:
  GET /api/audit-logs
  - ì‚¬ìš©ìë³„ í•„í„°
  - ì‘ì—…ë³„ í•„í„° (login, create_run, send_data ë“±)
  - ë‚ ì§œ ë²”ìœ„ í•„í„°
  - í˜ì´ì§€ë„¤ì´ì…˜ (50ê°œì”©)
  - ì •ë ¬ (ë‚ ì§œìˆœ)
```

## í•µì‹¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë° ê¸°ìˆ  ìŠ¤íƒ

### Backend (Node.js + TypeScript)
- **Express.js** - REST API ì„œë²„ í”„ë ˆì„ì›Œí¬
- **TypeScript** - íƒ€ì… ì•ˆì „ì„± ë° ê°œë°œ ìƒì‚°ì„±
- **PostgreSQL (pg)** - ì—”í„°í”„ë¼ì´ì¦ˆê¸‰ ë°ì´í„°ë² ì´ìŠ¤
- **bcrypt** - ë¹„ë°€ë²ˆí˜¸ í•´ì‹± (Salt Rounds: 10)
- **jsonwebtoken** - JWT ê¸°ë°˜ ì¸ì¦ (7ì¼ ìœ íš¨)
- **multer** - ë©€í‹°íŒŒíŠ¸ íŒŒì¼ ì—…ë¡œë“œ (ìµœëŒ€ 10MB)
- **ExcelJS** - Excel íŒŒì¼ ì½ê¸°/ì“°ê¸°
- **@faker-js/faker** - í˜„ì‹¤ì ì¸ ë”ë¯¸ ë°ì´í„° ìƒì„±
  - êµ­ê°€ë³„ ë¡œì¼€ì¼ ì§€ì› (ja, ko, en, zh_CN, zh_TW ë“±)
  - ìœ ì €ëª…, ì£¼ì†Œ, ì „í™”ë²ˆí˜¸, ìƒí’ˆëª… ë“± ìë™ ìƒì„±
  - êµ­ê°€ë³„ IP ëŒ€ì—­, í†µì‹ ì‚¬, ë””ë°”ì´ìŠ¤ ëª¨ë¸ ë“±
- **AI SDK**:
  - @anthropic-ai/sdk - Claude API
  - openai - GPT API
  - @google/generative-ai - Gemini API
- **child_process** - LogBus2 ë°”ì´ë„ˆë¦¬ ì œì–´

### Frontend (Next.js 14)
- **Next.js 14 App Router** - ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§
- **React 18** - UI ì»´í¬ë„ŒíŠ¸
- **Tailwind CSS** - ìœ í‹¸ë¦¬í‹° ìš°ì„  ìŠ¤íƒ€ì¼ë§
- **Framer Motion** - ì• ë‹ˆë©”ì´ì…˜
- **Context API** - ì „ì—­ ìƒíƒœ ê´€ë¦¬ (Auth, Language, Theme)
- **i18n** - ë‹¤êµ­ì–´ ì§€ì› (ko, en, zh)

### Database Schema (PostgreSQL)
- **users** - ì‚¬ìš©ì ì •ë³´, ì—­í• , ì¸ì¦
- **user_settings** - ì‚¬ìš©ìë³„ AI API Keys, ì„¤ì •
- **runs** - ë°ì´í„° ìƒì„± ì‹¤í–‰ ê¸°ë¡
- **audit_logs** - ê°ì‚¬ ë¡œê·¸ (ëª¨ë“  ì‘ì—… ì¶”ì )
- **excel_uploads** - ì—…ë¡œë“œëœ Excel íŒŒì¼ ë©”íƒ€ë°ì´í„°
- **sessions** - ì„¸ì…˜ ê´€ë¦¬ (ì„ íƒì , Redis ëŒ€ì²´ ê°€ëŠ¥)

## í•µì‹¬ ì»´í¬ë„ŒíŠ¸

### 1. Excel í…ì†Œë…¸ë¯¸ íŒŒì„œ (ExcelParser)

**ëª©ì **: AIê°€ ìƒì„±í•˜ê±°ë‚˜ ì‚¬ìš©ìê°€ ì—…ë¡œë“œí•œ 4-sheet Excel í…ì†Œë…¸ë¯¸ íŒŒì‹±

**ì…ë ¥**:
- excel-schema-generator/output/generated-schemas/ í´ë”ì˜ AI ìƒì„± Excel íŒŒì¼
- ë˜ëŠ” íŒŒì¼ ì—…ë¡œë“œ UIë¥¼ í†µí•œ ì‚¬ìš©ì ì œê³µ Excel íŒŒì¼

**ì¶œë ¥**:
- ParsedSchema ê°ì²´ (ì´ë²¤íŠ¸, ì†ì„±, í¼ë„, ìœ ì € ë°ì´í„°)

**Excel 4-Sheet êµ¬ì¡° (TaxonomyBuilderV2 ìƒì„±):**
```
ğŸ“‹ Sheet 1: #ìœ ì € ID ì²´ê³„
ì»¬ëŸ¼: ìœ í˜• | ì†ì„± ì´ë¦„ | ì†ì„± ë³„ì¹­ | ì†ì„± ì„¤ëª… | ê°’ ì„¤ëª…
- ê³„ì • ID, ë””ë°”ì´ìŠ¤ ID ë“± ìœ ì € ì‹ë³„ ì²´ê³„ ì •ì˜
- ThinkingEngineì˜ #account_id, #distinct_id ë§¤í•‘

ğŸ“‹ Sheet 2: #ì´ë²¤íŠ¸ ë°ì´í„°
ì»¬ëŸ¼: ì´ë²¤íŠ¸ëª… | ì´ë²¤íŠ¸ ë³„ì¹­ | ì´ë²¤íŠ¸ ì„¤ëª… | ì†ì„± ì´ë¦„ | ì†ì„± ë³„ì¹­ | ì†ì„± ì„¤ëª… | ì†ì„± íƒ€ì… | ì˜ˆì‹œ ê°’
- ì´ë²¤íŠ¸ì™€ í•´ë‹¹ ì´ë²¤íŠ¸ ì „ìš© ì†ì„±ì„ í•¨ê»˜ ì •ì˜
- event_nameê³¼ ì´ë²¤íŠ¸ ì „ìš© propertyë¥¼ í•œ ì‹œíŠ¸ì— í‘œí˜„
- ì˜ˆ: app_start ì´ë²¤íŠ¸ â†’ app_version, platform ë“±ì˜ ì†ì„±

ğŸ“‹ Sheet 3: #ê³µí†µ ì†ì„±
ì»¬ëŸ¼: ì†ì„± ì´ë¦„ | ì†ì„± ë³„ì¹­ | ì†ì„± ì„¤ëª… | ì†ì„± íƒ€ì… | ì˜ˆì‹œ ê°’
- ëª¨ë“  ì´ë²¤íŠ¸ì— ê³µí†µìœ¼ë¡œ ì ìš©ë˜ëŠ” ì†ì„±
- ì˜ˆ: user_id, session_id, device_model, os_version ë“±
- event_nameì´ ì—†ëŠ” ìˆœìˆ˜ ê³µí†µ ì†ì„±

ğŸ“‹ Sheet 4: #ìœ ì € ë°ì´í„°
ì»¬ëŸ¼: ì†ì„± ì´ë¦„ | ì†ì„± ë³„ì¹­ | ì†ì„± ì„¤ëª… | ì—…ë°ì´íŠ¸ ë°©ì‹ | ì˜ˆì‹œ ê°’ | íƒœê·¸
- user_set, user_setonce, user_add ë“±ì˜ ìœ ì € ì†ì„±
- ì˜ˆ: user_level (user_set), total_purchase_amount (user_add)
- íƒœê·¸: ê¸°ë³¸ ì •ë³´, í–‰ë™ ë°ì´í„°, ë§ˆì¼€íŒ… ë“±
```

**ì¶œë ¥ (TypeScript íƒ€ì… ì •ì˜):**
```typescript
// data-generator/src/types/schema.ts

export interface EventDefinition {
  event_name: string;              // ì´ë²¤íŠ¸ ì‹ë³„ì
  event_name_kr: string;           // í•œêµ­ì–´ëª…
  category: string;                // system, transaction, interaction ë“±
  required_previous_events?: string[];  // ì„ í–‰ ì´ë²¤íŠ¸ (AIê°€ ì¶”ë¡ )
  user_lifecycle_stage?: string[]; // new, active, returning, churned
  trigger_probability?: number;    // ë°œìƒ í™•ë¥  (0-1)
}

export interface PropertyDefinition {
  property_name: string;           // ì†ì„± í‚¤
  property_name_kr: string;        // í•œêµ­ì–´ëª…
  data_type: string;               // string, number, boolean, date
  event_name?: string;             // íŠ¹ì • ì´ë²¤íŠ¸ì—ë§Œ ì†í•˜ëŠ” ê²½ìš° (Sheet 2)
  description?: string;
}

export interface FunnelDefinition {
  name: string;                    // í¼ë„ ì‹ë³„ì
  description?: string;
  steps: string[];                 // event_name ë°°ì—´
  conversion_rate?: number;        // ì „ì²´ í¼ë„ ì „í™˜ìœ¨
}

export interface UserDataDefinition {
  property_name: string;           // ìœ ì € ì†ì„± í‚¤
  property_name_kr: string;
  data_type: string;
  update_method: string;           // user_set, user_setonce, user_add
  description?: string;
  tag?: string;                    // ê¸°ë³¸ ì •ë³´, í–‰ë™ ë°ì´í„° ë“±
}

export interface UserSegment {
  name: string;                    // ì„¸ê·¸ë¨¼íŠ¸ëª… (AIê°€ ìƒì„±)
  ratio?: number;                  // AIê°€ ê²°ì •í•œ ë¹„ìœ¨
  characteristics?: string;        // AIê°€ ë¶„ì„í•œ íŠ¹ì„±
}

export interface ParsedSchema {
  events: EventDefinition[];       // Sheet 2ì—ì„œ íŒŒì‹±
  properties: PropertyDefinition[]; // Sheet 2 (ì´ë²¤íŠ¸ ì†ì„±) + Sheet 3 (ê³µí†µ ì†ì„±)
  funnels: FunnelDefinition[];     // AIê°€ ì¶”ë¡ 
  userData: UserDataDefinition[];  // Sheet 4ì—ì„œ íŒŒì‹±
  userSegments?: UserSegment[];    // AIê°€ ìë™ ìƒì„± (Excelì—ëŠ” ì—†ìŒ)
}
```

### 2. ìœ ì € ì½”í˜¸íŠ¸ ìƒì„±ê¸° (Faker.js í†µí•©)

**ëª©ì **: ë‚ ì§œë³„ ì‹ ê·œ ìœ ì € ìƒì„± ë° ê¸°ì¡´ ìœ ì € ìƒëª…ì£¼ê¸° ê´€ë¦¬

**ì…ë ¥**:
- ì‹œë®¬ë ˆì´ì…˜ ë‚ ì§œ ë²”ìœ„ (ì˜ˆ: 2025-01-01 ~ 2025-01-30)
- DAU (Daily Active Users)
- **AIê°€ ìë™ ìƒì„±í•œ ìœ ì € ì„¸ê·¸ë¨¼íŠ¸ ë¹„ìœ¨** (Excelì— ì—†ìŒ, AIê°€ ì‹œë‚˜ë¦¬ì˜¤ ê¸°ë°˜ ìƒì„±)
  - ì˜ˆ: { new: 10%, core: 15%, regular: 50%, light: 25% }
- **êµ­ê°€ë³„ ìœ ì € ë¶„í¬** (ê¸°ë³¸ê°’: JP 30%, KR 25%, US 20%, CN 15%, TW 10%)

**ì½”í˜¸íŠ¸ ìƒì„± ë¡œì§**:
```typescript
function generateUserCohorts(
  dateRange: DateRange,
  dailyActiveUsers: number,
  newUserRatio: number
): Map<string, User[]> {
  const cohorts = new Map();
  const userPool: User[] = []; // ì „ì²´ ìœ ì € í’€

  for (const date of dateRange) {
    const newUserCount = Math.floor(dailyActiveUsers * newUserRatio);
    const returningUserCount = dailyActiveUsers - newUserCount;

    // 1. ì‹ ê·œ ìœ ì € ìƒì„± (ì„¤ì¹˜ì¼ = ì˜¤ëŠ˜)
    const newUsers = createNewUsers(newUserCount, date);
    userPool.push(...newUsers);

    // 2. ê¸°ì¡´ ìœ ì € ì¤‘ í™œì„±í™”ë  ìœ ì € ì„ íƒ
    const activeUsers = selectActiveUsers(
      userPool.filter(u => u.installDate < date),
      returningUserCount,
      date
    );

    // 3. í•´ë‹¹ ë‚ ì§œì˜ ì „ì²´ í™œì„± ìœ ì €
    cohorts.set(date, [...newUsers, ...activeUsers]);
  }

  return cohorts;
}
```

**ìœ ì € ìƒëª…ì£¼ê¸° ìƒíƒœ (Faker.js í†µí•©)**:
```typescript
interface User {
  id: string;
  installDate: Date;           // ì„¤ì¹˜ì¼
  lastActiveDate: Date;         // ë§ˆì§€ë§‰ í™œì„± ë‚ ì§œ
  lifecycleStage: 'new' | 'active' | 'returning' | 'dormant' | 'churned';
  segment: string;              // AI ê²°ì • ì„¸ê·¸ë¨¼íŠ¸

  // Faker.js ìƒì„± - êµ­ê°€ë³„ í˜„ì‹¤ì  ë°ì´í„°
  country: string;              // "ì¼ë³¸", "ëŒ€í•œë¯¼êµ­" ë“±
  countryCode: string;          // "JP", "KR" ë“±
  locale: string;               // "ja", "ko" (Faker.js ë¡œì¼€ì¼)
  name: string;                 // Faker.js person.fullName() with locale (ì¼ë³¸ì´ë©´ ì¼ë³¸ì–´ ì´ë¦„)
  email: string;                // Faker.js internet.email()
  phone: string;                // Faker.js phone.number() with locale
  deviceModel: string;          // Faker.js phone.model()

  sessionHistory: Session[];    // ì„¸ì…˜ ì´ë ¥
  completedEvents: Set<string>; // ì™„ë£Œí•œ ì´ë²¤íŠ¸ ëª©ë¡ (ì˜ì¡´ì„± ì²´í¬ìš©)
  currentLevel: number;
  totalUsageTime: number;
}
```

### 3. ì¼ìë³„ ì´ë²¤íŠ¸ ìƒì„±ê¸° (Faker.js + AI ê²°í•©)

**ëª©ì **: ê° ë‚ ì§œë³„ë¡œ í˜„ì‹¤ì ì¸ ì´ë²¤íŠ¸ ì‹œí€€ìŠ¤ ìƒì„±

**ë°ì´í„° ìƒì„± ìš°ì„ ìˆœìœ„**:
1. **AI ì •ì˜ ë²”ìœ„ ìš°ì„ ** - AIê°€ ë¶„ì„í•œ ë°ì´í„° ë²”ìœ„ ì‚¬ìš©
2. **Faker.js í´ë°±** - AI ë²”ìœ„ ì—†ì„ ì‹œ ì†ì„± ì´ë¦„ ê¸°ë°˜ Faker.js ìƒì„±
3. **êµ­ê°€ë³„ ë¡œì¼€ì¼** - ìœ ì € êµ­ê°€ì— ë§ëŠ” Faker ë¡œì¼€ì¼ ì‚¬ìš©

**í”„ë¡œì„¸ìŠ¤**:

```typescript
async function generateDailyEvents(
  date: Date,
  activeUsers: User[],
  schema: ParsedSchema,
  aiRanges: DataRanges
): Promise<TEEvent[]> {
  const dailyEvents: TEEvent[] = [];

  for (const user of activeUsers) {
    // 1. ìœ ì € ìƒëª…ì£¼ê¸° ë‹¨ê³„ í™•ì¸
    const stage = determineLifecycleStage(user, date);

    // 2. ì„¸ì…˜ ìŠ¤ì¼€ì¤„ ìƒì„± (í•´ë‹¹ ë‚ ì§œ ë‚´)
    const sessions = generateSessionsForDay(user, date);

    for (const session of sessions) {
      // 3. ì²« ì´ë²¤íŠ¸ëŠ” í•­ìƒ app_start
      const events = [createEvent('app_start', user, session.start)];

      // 4. ì‹ ê·œ ìœ ì €ë©´ ì˜¨ë³´ë”© í¼ë„
      if (stage === 'new' && !user.completedEvents.has('tutorial_complete')) {
        const onboardingEvents = generateFunnelEvents(
          user,
          schema.funnels.find(f => f.name === 'onboarding'),
          session.start
        );
        events.push(...onboardingEvents);
      }

      // 5. ì¼ë°˜ ì„œë¹„ìŠ¤ ì´ë²¤íŠ¸ (ì˜ì¡´ì„± ì¤€ìˆ˜)
      const serviceEvents = generateServiceEvents(
        user,
        session,
        schema,
        aiRanges
      );
      events.push(...serviceEvents);

      // 6. ì„¸ì…˜ ì¢…ë£Œ ì´ë²¤íŠ¸
      events.push(createEvent('app_end', user, session.end));

      // 7. TE í˜•ì‹ìœ¼ë¡œ ë³€í™˜
      const teEvents = events.map(e => formatToTE(e, user, schema));

      // 8. user_set/user_add ì´ë²¤íŠ¸ ìƒì„±
      const userUpdates = generateUserUpdates(user, events);

      dailyEvents.push(...teEvents, ...userUpdates);

      // 9. ìœ ì € ìƒíƒœ ì—…ë°ì´íŠ¸
      updateUserState(user, events);
    }
  }

  // ì‹œê°„ìˆœ ì •ë ¬
  return dailyEvents.sort((a, b) =>
    new Date(a['#event_time']).getTime() - new Date(b['#event_time']).getTime()
  );
}
```

### 4. ì´ë²¤íŠ¸ ì˜ì¡´ì„± ê´€ë¦¬ì

**ëª©ì **: ì´ë²¤íŠ¸ê°€ í˜„ì‹¤ì ì¸ ìˆœì„œë¡œ ë°œìƒí•˜ë„ë¡ ë³´ì¥

**ì˜ì¡´ì„± ê·¸ë˜í”„**:
```typescript
class EventDependencyManager {
  private graph: Map<string, string[]>; // event -> required previous events

  canEventOccur(
    eventName: string,
    user: User
  ): boolean {
    const dependencies = this.graph.get(eventName) || [];

    // ëª¨ë“  ì„ í–‰ ì´ë²¤íŠ¸ê°€ ë°œìƒí–ˆëŠ”ì§€ í™•ì¸
    return dependencies.every(dep =>
      user.completedEvents.has(dep)
    );
  }

  getNextPossibleEvents(user: User): string[] {
    return Array.from(this.graph.keys()).filter(event =>
      this.canEventOccur(event, user)
    );
  }
}
```

**ì˜ˆì‹œ ì˜ì¡´ì„±**:
```
app_install (ì„¤ì¹˜)
  â†“
app_start (ì•± ì‹œì‘)
  â†“
sign_up (íšŒì›ê°€ì…)
  â†“
login (ë¡œê·¸ì¸)
  â†“
tutorial_start (íŠœí† ë¦¬ì–¼ ì‹œì‘)
  â†“
tutorial_complete (íŠœí† ë¦¬ì–¼ ì™„ë£Œ)
  â†“
stage_1_start (ìŠ¤í…Œì´ì§€ 1 ì‹œì‘)
  â†“
stage_1_clear (ìŠ¤í…Œì´ì§€ 1 í´ë¦¬ì–´)
  â†“
iap_purchase (ì¸ì•± ê²°ì œ) - ì„ íƒì 
```

### 5. ì¼ìë³„ íŒŒì¼ ìƒì„±ê¸°

**ëª©ì **: LogBus2ê°€ ìˆœì°¨ ì²˜ë¦¬í•  ìˆ˜ ìˆë„ë¡ ë‚ ì§œë³„ JSONL íŒŒì¼ ìƒì„±

**ì¶œë ¥ êµ¬ì¡°**:
```
output/
â”œâ”€â”€ runs/                          # ì‹¤í–‰ ë©”íƒ€ë°ì´í„° (LogBus2ì™€ ë¶„ë¦¬)
â”‚   â”œâ”€â”€ run_20250105_143022/
â”‚   â”‚   â”œâ”€â”€ metadata.json          # ì‹¤í–‰ ì„¤ì • ì •ë³´
â”‚   â”‚   â”œâ”€â”€ summary.json           # í†µê³„ ìš”ì•½
â”‚   â”‚   â””â”€â”€ schema.xlsx            # ì‚¬ìš©ëœ Excel ìŠ¤í‚¤ë§ˆ ë°±ì—…
â”‚   â”œâ”€â”€ run_20250105_150033/
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ run_20250106_090000/
â”‚       â””â”€â”€ ...
â””â”€â”€ data/                          # LogBus2ê°€ ì½ëŠ” ìˆœìˆ˜ ë°ì´í„°
    â”œâ”€â”€ run_20250105_143022/
    â”‚   â”œâ”€â”€ 2025-01-01.jsonl       # 1ì›” 1ì¼ ì´ë²¤íŠ¸ë§Œ
    â”‚   â”œâ”€â”€ 2025-01-02.jsonl       # 1ì›” 2ì¼ ì´ë²¤íŠ¸ë§Œ
    â”‚   â”œâ”€â”€ 2025-01-03.jsonl
    â”‚   â”œâ”€â”€ ...
    â”‚   â””â”€â”€ 2025-01-30.jsonl
    â”œâ”€â”€ run_20250105_150033/
    â”‚   â””â”€â”€ ...
    â””â”€â”€ run_20250106_090000/
        â””â”€â”€ ...
```

**í´ë” ì—­í• **:
- `output/runs/` : ì‹¤í–‰ ì •ë³´, í†µê³„, Excel ë°±ì—… (í”„ë¡ íŠ¸ì—”ë“œ ë¶„ì„ìš©)
- `output/data/` : ìˆœìˆ˜ JSONL ë°ì´í„° (LogBus2 ì „ì†¡ìš©)

**metadata.json**:
```json
{
  "runId": "run_20250105_143022",
  "createdAt": "2025-01-05T14:30:22Z",
  "config": {
    "schemaFile": "example_service_schema.xlsx",
    "dateRange": {
      "start": "2025-01-01",
      "end": "2025-01-30"
    },
    "dau": 1000,
    "newUserRatio": 0.05,
    "totalUsers": 1500
  },
  "appId": "your_app_id",
  "receiverUrl": "https://te-receiver-naver.thinkingdata.kr/"
}
```

**summary.json**:
```json
{
  "totalEvents": 150420,
  "eventsByDate": {
    "2025-01-01": 5020,
    "2025-01-02": 5100,
    ...
  },
  "eventsByType": {
    "app_start": 30000,
    "stage_clear": 25000,
    ...
  },
  "usersBySegment": {
    "whale": 75,
    "regular": 450,
    "casual": 975
  }
}
```

### 6. LogBus2 í†µí•©

**ì„¤ì • ìƒì„±**:
```typescript
function generateLogBusConfig(runId: string, appId: string, pushUrl: string) {
  // ìˆœìˆ˜ ë°ì´í„° í´ë”ë§Œ ì§€ì • (ë©”íƒ€ë°ì´í„° ì œì™¸)
  const dataPath = path.join(process.cwd(), 'output', 'data', runId);

  return {
    "datasource": [{
      "type": "file",
      "file_patterns": [`${dataPath}/*.jsonl`],  // ì˜¤ì§ JSONLë§Œ
      "app_id": appId,
      "http_compress": "gzip",
      "unit_remove": "day",
      "offset_remove": 7
    }],
    "push_url": pushUrl,
    "cpu_limit": 4
  };
}
```

### 7. íŒŒì¼ ë³´ê´€ ê´€ë¦¬ ì‹œìŠ¤í…œ

**ëª©ì **: ë””ìŠ¤í¬ ê³µê°„ ê´€ë¦¬ ë° ì˜¤ë˜ëœ íŒŒì¼ ìë™ ì •ë¦¬

**êµ¬ì„±**:
```typescript
interface FileRetentionConfig {
  dataRetentionDays: number;      // ë°ì´í„° íŒŒì¼ ë³´ê´€ ê¸°ê°„ (ê¸°ë³¸: 7ì¼)
  excelRetentionDays: number;     // Excel íŒŒì¼ ë³´ê´€ ê¸°ê°„ (ê¸°ë³¸: 30ì¼)
  autoDeleteAfterSend: boolean;   // ì „ì†¡ í›„ ì¦‰ì‹œ ì‚­ì œ (ê¸°ë³¸: false)
}

class FileRetentionManager {
  // ì˜ˆì•½ëœ ì •ë¦¬ ì‘ì—… (24ì‹œê°„ë§ˆë‹¤ ì‹¤í–‰)
  scheduleCleanup(): void {
    setInterval(() => {
      this.cleanupOldFiles();
    }, 24 * 60 * 60 * 1000);
  }

  // ë³´ê´€ ê¸°ê°„ ì´ˆê³¼ íŒŒì¼ ì‚­ì œ
  cleanupOldFiles(): void {
    const now = Date.now();

    // 1. ë°ì´í„° íŒŒì¼ ì •ë¦¬
    this.cleanupDirectory(
      'output/data/',
      this.config.dataRetentionDays,
      now
    );

    // 2. Excel íŒŒì¼ ì •ë¦¬
    this.cleanupDirectory(
      'excel-schema-generator/output/',
      this.config.excelRetentionDays,
      now
    );

    // 3. ë©”íƒ€ë°ì´í„° ì •ë¦¬
    this.cleanupDirectory(
      'output/metadata/',
      this.config.dataRetentionDays,
      now
    );
  }

  // ì „ì†¡ ì™„ë£Œ í›„ ì¦‰ì‹œ ì‚­ì œ
  deleteAfterTransmission(runId: string): void {
    if (this.config.autoDeleteAfterSend) {
      const dataDir = path.join('output/data', runId);
      fs.rmSync(dataDir, { recursive: true, force: true });
      console.log(`ğŸ—‘ï¸  Auto-deleted: ${dataDir}`);
    }
  }
}
```

**ì •ë¦¬ ì •ì±…**:
- **ë°ì´í„° íŒŒì¼** (output/data/run_XXX/): ê¸°ë³¸ 7ì¼ ë³´ê´€
- **Excel íŒŒì¼** (excel-schema-generator/output/): ê¸°ë³¸ 30ì¼ ë³´ê´€
- **ë©”íƒ€ë°ì´í„°** (output/metadata/run_XXX/): ê¸°ë³¸ 7ì¼ ë³´ê´€
- **ì „ì†¡ í›„ ì¦‰ì‹œ ì‚­ì œ**: ì„¤ì • ì‹œ ì „ì†¡ ì™„ë£Œ ì¦‰ì‹œ ë°ì´í„° íŒŒì¼ë§Œ ì‚­ì œ

**ì‹¤í–‰ ì‹œì **:
1. ì„œë²„ ì‹œì‘ ì‹œ ì´ˆê¸° ì •ë¦¬ 1íšŒ ì‹¤í–‰
2. 24ì‹œê°„ë§ˆë‹¤ ì˜ˆì•½ ì‹¤í–‰
3. ThinkingEngine ì „ì†¡ ì™„ë£Œ ì‹œ (ì˜µì…˜)

**ì¤‘ìš”**:
- LogBus2ëŠ” `output/data/run_XXX/*.jsonl` ë§Œ ì½ìŒ
- `output/runs/run_XXX/` ì˜ ë©”íƒ€ë°ì´í„°ëŠ” ì½ì§€ ì•ŠìŒ
- ì´ë ‡ê²Œ í•˜ë©´ LogBus2ê°€ JSON íŒŒì¼ì„ ì´ë²¤íŠ¸ë¡œ ì˜¤ì¸í•˜ëŠ” ë¬¸ì œ ë°©ì§€

**ìˆœì°¨ ì—…ë¡œë“œ ë³´ì¥**:
- LogBus2ëŠ” íŒŒì¼ëª… ìˆœì„œëŒ€ë¡œ ì²˜ë¦¬í•˜ë¯€ë¡œ `YYYY-MM-DD.jsonl` í˜•ì‹ì´ ìë™ìœ¼ë¡œ ë‚ ì§œìˆœ ë³´ì¥

## í”„ë¡ íŠ¸ì—”ë“œ UI êµ¬ì¡°

### Next.js 14 App Router êµ¬ì¡°

```
/app
â”œâ”€â”€ /login
â”‚   â””â”€â”€ page.tsx              # ë¡œê·¸ì¸ í˜ì´ì§€ (JWT ì¸ì¦)
â”‚
â”œâ”€â”€ /dashboard
â”‚   â”œâ”€â”€ page.tsx              # ëŒ€ì‹œë³´ë“œ í™ˆ
â”‚   â”‚                         # - Quick Launch (ë°ì´í„° ìƒì„±ê¸° ë°”ë¡œê°€ê¸°)
â”‚   â”‚                         # - ê³µì§€ì‚¬í•­ (ìµœì‹  ê¸°ëŠ¥, íŒ)
â”‚   â”‚                         # - FileManager (ë°ì´í„° íŒŒì¼, Excel íŒŒì¼)
â”‚   â”‚
â”‚   â”œâ”€â”€ /generator
â”‚   â”‚   â””â”€â”€ page.tsx          # ë°ì´í„° ìƒì„±ê¸° (í†µí•© UI)
â”‚   â”‚                         # - Excel ìƒì„±/ì—…ë¡œë“œ
â”‚   â”‚                         # - ë°ì´í„° ìƒì„± ì„¤ì •
â”‚   â”‚                         # - ì§„í–‰ ìƒí™© ëª¨ë‹ˆí„°ë§
â”‚   â”‚                         # - ThinkingEngine ì „ì†¡
â”‚   â”‚
â”‚   â”œâ”€â”€ /users
â”‚   â”‚   â””â”€â”€ page.tsx          # ì‚¬ìš©ì ê´€ë¦¬ (Admin ì „ìš©)
â”‚   â”‚                         # - ì‚¬ìš©ì ëª©ë¡, ìƒì„±, ìˆ˜ì •, ì‚­ì œ
â”‚   â”‚
â”‚   â”œâ”€â”€ /audit
â”‚   â”‚   â””â”€â”€ page.tsx          # ê°ì‚¬ ë¡œê·¸ (Admin ì „ìš©)
â”‚   â”‚                         # - í•„í„°ë§, ê²€ìƒ‰, í˜ì´ì§€ë„¤ì´ì…˜
â”‚   â”‚
â”‚   â””â”€â”€ /settings
â”‚       â””â”€â”€ page.tsx          # ì„¤ì • (ì‚¬ìš©ìë³„)
â”‚                             # - AI API Keys
â”‚                             # - ThinkingEngine ì„¤ì •
â”‚                             # - íŒŒì¼ ë³´ê´€ ì •ì±…
â”‚
â”œâ”€â”€ layout.tsx                # ê³µí†µ ë ˆì´ì•„ì›ƒ (í—¤ë”, ì‚¬ì´ë“œë°”)
â””â”€â”€ globals.css               # ì „ì—­ ìŠ¤íƒ€ì¼ (Tailwind, í…Œë§ˆ)
```

### ì»´í¬ë„ŒíŠ¸ êµ¬ì¡°

```
/components
â”œâ”€â”€ /layout
â”‚   â”œâ”€â”€ Header.tsx            # í—¤ë” (ì‚¬ìš©ì ì •ë³´, ì–¸ì–´ ì„ íƒ)
â”‚   â””â”€â”€ Sidebar.tsx           # ì‚¬ì´ë“œë°” (ë„¤ë¹„ê²Œì´ì…˜)
â”‚
â”œâ”€â”€ /dashboard
â”‚   â”œâ”€â”€ FileManager.tsx       # íŒŒì¼ ê´€ë¦¬ì (í†µí•©)
â”‚   â”‚                         # - ë°ì´í„° íŒŒì¼ ëª©ë¡/ì‚­ì œ
â”‚   â”‚                         # - Excel íŒŒì¼ ëª©ë¡/ì‚­ì œ/ë‹¤ìš´ë¡œë“œ
â”‚   â”‚                         # - ë³´ê´€ ê¸°ê°„ ì—°ì¥
â”‚   â”œâ”€â”€ QuickLaunch.tsx       # ë¹ ë¥¸ ì‹¤í–‰ ë²„íŠ¼ë“¤
â”‚   â””â”€â”€ SystemStatus.tsx      # ì‹œìŠ¤í…œ ìƒíƒœ (LogBus2, DB ë“±)
â”‚
â”œâ”€â”€ /settings
â”‚   â”œâ”€â”€ AISettings.tsx        # AI ì„¤ì • (Provider, API Keys)
â”‚   â”œâ”€â”€ TESettings.tsx        # ThinkingEngine ì„¤ì •
â”‚   â””â”€â”€ FileRetention.tsx     # íŒŒì¼ ë³´ê´€ ì •ì±… ì„¤ì •
â”‚
â”œâ”€â”€ FileUploadZone.tsx        # íŒŒì¼ ì—…ë¡œë“œ ë“œë˜ê·¸ ì•¤ ë“œë¡­
â””â”€â”€ LanguageSwitcher.tsx      # ì–¸ì–´ ì „í™˜ê¸°
```

### ì£¼ìš” Context

```typescript
// AuthContext - ì¸ì¦ ìƒíƒœ ê´€ë¦¬
interface AuthContextType {
  user: User | null;
  login: (username: string, password: string) => Promise<void>;
  logout: () => void;
  isLoading: boolean;
}

// LanguageContext - ë‹¤êµ­ì–´ ì§€ì›
interface LanguageContextType {
  language: 'ko' | 'en' | 'zh';
  setLanguage: (lang: 'ko' | 'en' | 'zh') => void;
  t: Translations; // ë²ˆì—­ ê°ì²´
}

// ThemeContext - í…Œë§ˆ ê´€ë¦¬
interface ThemeContextType {
  theme: 'dark' | 'light' | 'terminal';
  setTheme: (theme: 'dark' | 'light' | 'terminal') => void;
}
```

### ì£¼ìš” í™”ë©´ êµ¬ì„±

#### 1. ë¡œê·¸ì¸ í˜ì´ì§€ (/login)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                              â”‚
â”‚                  ThinkingEngine Platform                     â”‚
â”‚               AI ê¸°ë°˜ ì´ë²¤íŠ¸ ë°ì´í„° ìƒì„±ê¸°                   â”‚
â”‚                                                              â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚     Username:      â”‚                   â”‚                    â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                                                              â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚     Password:      â”‚ â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢  â”‚                    â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                                                              â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚              â”‚      ğŸ” ë¡œê·¸ì¸             â”‚                  â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                                              â”‚
â”‚                    [ğŸŒ English | í•œêµ­ì–´ | ä¸­æ–‡]             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2. ëŒ€ì‹œë³´ë“œ í™ˆ (/dashboard)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [ThinkingEngine]              [ğŸŒ í•œêµ­ì–´]  [ğŸ‘¤ admin] [ğŸšª] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â˜° ë©”ë‰´            â”‚                                          â”‚
â”‚                   â”‚  í™˜ì˜í•©ë‹ˆë‹¤, admin ë‹˜                    â”‚
â”‚ ğŸ“Š ëŒ€ì‹œë³´ë“œ       â”‚  í”Œë«í¼ ë²„ì „: v1.0.0                     â”‚
â”‚ ğŸ¤– ë°ì´í„° ìƒì„±ê¸°  â”‚  ì—­í• : ADMIN | ì„¸ì…˜: ACTIVE              â”‚
â”‚ ğŸ‘¥ ì‚¬ìš©ì ê´€ë¦¬    â”‚                                          â”‚
â”‚ ğŸ“‹ ê°ì‚¬ ë¡œê·¸      â”‚  Quick Launch                            â”‚
â”‚ âš™ï¸  ì„¤ì •          â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚                   â”‚  â”‚ğŸ†• ìƒˆë¡œ ë§Œë“¤ê¸°â”‚  â”‚ğŸ“ Excel ì—…ë¡œë“œâ”‚    â”‚
â”‚                   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                   â”‚                                          â”‚
â”‚                   â”‚  ğŸ“¢ ê³µì§€ì‚¬í•­                             â”‚
â”‚                   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚                   â”‚  â”‚[NEW] AI ê²€ì¦ íŒŒì´í”„ë¼ì¸ ì¶”ê°€      â”‚  â”‚
â”‚                   â”‚  â”‚2025-01-13                         â”‚  â”‚
â”‚                   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚                   â”‚  â”‚[TIP] Gemini API ì§€ì› ì¶”ê°€        â”‚  â”‚
â”‚                   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                   â”‚                                          â”‚
â”‚                   â”‚  ğŸ“‚ íŒŒì¼ ê´€ë¦¬                            â”‚
â”‚                   â”‚  [ë°ì´í„° íŒŒì¼] | [Excel íŒŒì¼]           â”‚
â”‚                   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚                   â”‚  â”‚ run_123  | 150K events | 7ì¼ ë‚¨ìŒâ”‚   â”‚
â”‚                   â”‚  â”‚ [ë‹¤ìš´ë¡œë“œ] [ì—°ì¥] [ì‚­ì œ]         â”‚   â”‚
â”‚                   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3. ë°ì´í„° ìƒì„±ê¸° (/dashboard/generator)

ìƒíƒœ ê¸°ë°˜ UI ë Œë”ë§:

```typescript
type GeneratorStep =
  | 'mode-selection'       // ì‹œì‘: ìƒˆë¡œ ë§Œë“¤ê¸° vs ì—…ë¡œë“œ
  | 'excel-generation'     // Excel ìƒì„± ì¤‘
  | 'excel-upload'         // Excel ì—…ë¡œë“œ ì¤‘
  | 'excel-preview'        // Excel ë¯¸ë¦¬ë³´ê¸°
  | 'data-config'          // ë°ì´í„° ìƒì„± ì„¤ì •
  | 'data-generation'      // ë°ì´í„° ìƒì„± ì¤‘
  | 'data-complete'        // ë°ì´í„° ìƒì„± ì™„ë£Œ
  | 'data-sending'         // ThinkingEngine ì „ì†¡ ì¤‘
  | 'send-complete';       // ì „ì†¡ ì™„ë£Œ
```

#### 4. ì‚¬ìš©ì ê´€ë¦¬ (/dashboard/users) - Admin ì „ìš©

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ‘¥ ì‚¬ìš©ì ê´€ë¦¬                          [+ ìƒˆ ì‚¬ìš©ì ì¶”ê°€] â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚Usernameâ”‚ Email        â”‚ Full Nameâ”‚ Role   â”‚ Actions â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚admin   â”‚admin@te.com  â”‚Admin Userâ”‚ ADMIN  â”‚[Edit][X]â”‚  â”‚
â”‚  â”‚user1   â”‚user1@te.com  â”‚User One  â”‚ USER   â”‚[Edit][X]â”‚  â”‚
â”‚  â”‚viewer1 â”‚view@te.com   â”‚Viewer    â”‚ VIEWER â”‚[Edit][X]â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                              â”‚
â”‚  ì´ 3ëª… | í˜ì´ì§€ 1/1                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 5. ì„¤ì • (/dashboard/settings)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âš™ï¸ ì„¤ì •                                                     â”‚
â”‚                                                              â”‚
â”‚  ğŸ¤– AI ì„¤ì •                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Anthropic API Key:  [sk-ant-*********************]   â”‚  â”‚
â”‚  â”‚ OpenAI API Key:     [sk-*********************]      â”‚  â”‚
â”‚  â”‚ Gemini API Key:     [*********************]         â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚ Excel AI Provider:  [Anthropic â–¼]                   â”‚  â”‚
â”‚  â”‚ Data AI Provider:   [Anthropic â–¼]                   â”‚  â”‚
â”‚  â”‚ Validation Tier:    [Fast â–¼] (Balanced, Custom)    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                              â”‚
â”‚  ğŸ¯ ThinkingEngine ì„¤ì •                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ App ID:             [1edbbf43c73d4b0ba513f0383714ba5d] â”‚
â”‚  â”‚ Receiver URL:       [https://te-receiver-naver...] â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                              â”‚
â”‚  ğŸ“ íŒŒì¼ ë³´ê´€ ì •ì±…                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ë°ì´í„° íŒŒì¼ ë³´ê´€ ê¸°ê°„:    [7] ì¼                     â”‚  â”‚
â”‚  â”‚ Excel íŒŒì¼ ë³´ê´€ ê¸°ê°„:     [30] ì¼                    â”‚  â”‚
â”‚  â”‚ [ ] ì „ì†¡ í›„ ì¦‰ì‹œ ì‚­ì œ                                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                              â”‚
â”‚                      [ì·¨ì†Œ]  [ì €ì¥]                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## íŒŒì¼ êµ¬ì¡°

```
demo_data_gen/
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ common/
â”‚   â”‚   â””â”€â”€ ARCHITECTURE.md          # ì´ íŒŒì¼ (ìµœì‹  ì—…ë°ì´íŠ¸)
â”‚   â”œâ”€â”€ migration/
â”‚   â”‚   â””â”€â”€ MIGRATION_GUIDE.md       # ë§ˆì´ê·¸ë ˆì´ì…˜ ê°€ì´ë“œ
â”‚   â”œâ”€â”€ platforms/
â”‚   â”‚   â”œâ”€â”€ DEPLOYMENT_GUIDE.md      # ë°°í¬ ê°€ì´ë“œ
â”‚   â”‚   â””â”€â”€ DOCKER_GUIDE.md          # Docker ê°€ì´ë“œ
â”‚   â””â”€â”€ nodejs-study-presentation.md # Node.js ìŠ¤í„°ë”” ë°œí‘œìë£Œ
â”‚
â”œâ”€â”€ excel-schema-generator/          # Excel í…ì†Œë…¸ë¯¸ ìƒì„±ê¸°
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ schema-generator.ts      # ExcelSchemaGenerator ë©”ì¸ í´ë˜ìŠ¤
â”‚   â”‚   â”œâ”€â”€ taxonomy-builder-v2.ts   # TaxonomyBuilderV2 (3-stage AI)
â”‚   â”‚   â””â”€â”€ types.ts                 # íƒ€ì… ì •ì˜
â”‚   â”œâ”€â”€ prompts/                     # AI í”„ë¡¬í”„íŠ¸
â”‚   â”‚   â”œâ”€â”€ stage1-events.md         # Stage 1: ì´ë²¤íŠ¸/ì†ì„± ì„¤ê³„
â”‚   â”‚   â”œâ”€â”€ stage2-optimize.md       # Stage 2: ë°ì´í„° êµ¬ì¡° ìµœì í™”
â”‚   â”‚   â””â”€â”€ stage3-excel.md          # Stage 3: 4-sheet Excel ìƒì„±
â”‚   â”œâ”€â”€ output/
â”‚   â”‚   â””â”€â”€ generated-schemas/       # AI ìƒì„± Excel ì €ì¥ì†Œ
â”‚   â”‚       â”œâ”€â”€ game_taxonomy.xlsx
â”‚   â”‚       â”œâ”€â”€ commerce_taxonomy.xlsx
â”‚   â”‚       â””â”€â”€ ...
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ tsconfig.json
â”‚
â”œâ”€â”€ data-generator/                  # ë°ì´í„° ìƒì„± ë°±ì—”ë“œ + API
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”‚   â”œâ”€â”€ server.ts            # Express API ì„œë²„ (í¬íŠ¸ 3001)
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.ts              # ì¸ì¦ ë¡œì§ (JWT, bcrypt)
â”‚   â”‚   â”‚   â”œâ”€â”€ middleware.ts        # ì¸ì¦/ê¶Œí•œ ë¯¸ë“¤ì›¨ì–´
â”‚   â”‚   â”‚   â”œâ”€â”€ audit-middleware.ts  # ê°ì‚¬ ë¡œê·¸ ë¯¸ë“¤ì›¨ì–´
â”‚   â”‚   â”‚   â””â”€â”€ routes/
â”‚   â”‚   â”‚       â”œâ”€â”€ excel.ts         # Excel ê´€ë ¨ API
â”‚   â”‚   â”‚       â””â”€â”€ files.ts         # íŒŒì¼ ê´€ë¦¬ API
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ db/                      # PostgreSQL ì—°ë™
â”‚   â”‚   â”‚   â”œâ”€â”€ connection.ts        # DB ì»¤ë„¥ì…˜ í’€
â”‚   â”‚   â”‚   â”œâ”€â”€ schema.sql           # í…Œì´ë¸” ìŠ¤í‚¤ë§ˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ migrate.ts           # ë§ˆì´ê·¸ë ˆì´ì…˜ ìŠ¤í¬ë¦½íŠ¸
â”‚   â”‚   â”‚   â”œâ”€â”€ update-passwords.ts  # ë¹„ë°€ë²ˆí˜¸ ì—…ë°ì´íŠ¸
â”‚   â”‚   â”‚   â””â”€â”€ repositories/        # Repository íŒ¨í„´
â”‚   â”‚   â”‚       â”œâ”€â”€ user-repository.ts
â”‚   â”‚   â”‚       â”œâ”€â”€ user-settings-repository.ts
â”‚   â”‚   â”‚       â””â”€â”€ audit-repository.ts
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ excel/
â”‚   â”‚   â”‚   â””â”€â”€ parser.ts            # ExcelParser (4-sheet íŒŒì‹±)
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ ai/
â”‚   â”‚   â”‚   â”œâ”€â”€ client.ts            # AI API í˜¸ì¶œ (Multi-Provider)
â”‚   â”‚   â”‚   â”œâ”€â”€ prompts.ts           # AI í”„ë¡¬í”„íŠ¸
â”‚   â”‚   â”‚   â”œâ”€â”€ rule-validators.ts   # AI ê²€ì¦ ê·œì¹™
â”‚   â”‚   â”‚   â””â”€â”€ validation-pipeline.ts # AI ê²€ì¦ íŒŒì´í”„ë¼ì¸
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ generators/
â”‚   â”‚   â”‚   â”œâ”€â”€ cohort-generator.ts  # ìœ ì € ì½”í˜¸íŠ¸ ìƒì„± (Faker.js)
â”‚   â”‚   â”‚   â”œâ”€â”€ event-generator.ts   # ì¼ìë³„ ì´ë²¤íŠ¸ ìƒì„±
â”‚   â”‚   â”‚   â”œâ”€â”€ marketing-generator.ts # ë§ˆì¼€íŒ… ë°ì´í„° ìƒì„±
â”‚   â”‚   â”‚   â”œâ”€â”€ dependency-manager.ts # ì´ë²¤íŠ¸ ì˜ì¡´ì„± ê´€ë¦¬
â”‚   â”‚   â”‚   â””â”€â”€ faker-utils.ts       # Faker.js êµ­ê°€ë³„ ìœ í‹¸
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ formatters/
â”‚   â”‚   â”‚   â””â”€â”€ te-formatter.ts      # ThinkingEngine í¬ë§· ë³€í™˜
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ logbus/
â”‚   â”‚   â”‚   â””â”€â”€ controller.ts        # LogBus2Controller (daemon.json, ì „ì†¡)
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”‚   â””â”€â”€ analysis-excel-generator.ts # AI ë¶„ì„ ê²°ê³¼ Excel ìƒì„±
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ data-generator.ts        # DataGenerator ë©”ì¸ í´ë˜ìŠ¤
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ types/
â”‚   â”‚       â”œâ”€â”€ schema.ts            # ParsedSchema, EventDefinition ë“±
â”‚   â”‚       â”œâ”€â”€ user.ts              # User, UserSegment íƒ€ì…
â”‚   â”‚       â”œâ”€â”€ event.ts             # Event íƒ€ì…
â”‚   â”‚       â”œâ”€â”€ te-format.ts         # ThinkingEngine í¬ë§· íƒ€ì…
â”‚   â”‚       â””â”€â”€ country.ts           # êµ­ê°€ë³„ ì„¤ì •
â”‚   â”‚
â”‚   â”œâ”€â”€ output/                      # ìƒì„± ë°ì´í„° ì¶œë ¥
â”‚   â”‚   â”œâ”€â”€ runs/                    # ì‹¤í–‰ ë©”íƒ€ë°ì´í„°
â”‚   â”‚   â”‚   â””â”€â”€ run_XXX/
â”‚   â”‚   â”‚       â”œâ”€â”€ metadata.json    # ì‹¤í–‰ ì„¤ì • ì •ë³´
â”‚   â”‚   â”‚       â”œâ”€â”€ summary.json     # í†µê³„ ìš”ì•½
â”‚   â”‚   â”‚       â””â”€â”€ schema.xlsx      # ì‚¬ìš©ëœ Excel ë°±ì—…
â”‚   â”‚   â”œâ”€â”€ data/                    # LogBus2 ì „ì†¡ìš© JSONL
â”‚   â”‚   â”‚   â””â”€â”€ run_XXX/
â”‚   â”‚   â”‚       â”œâ”€â”€ 2025-01-01.jsonl
â”‚   â”‚   â”‚       â”œâ”€â”€ 2025-01-02.jsonl
â”‚   â”‚   â”‚       â””â”€â”€ ...
â”‚   â”‚   â””â”€â”€ analysis-excel/          # AI ë¶„ì„ ê²°ê³¼ Excel
â”‚   â”‚       â””â”€â”€ analysis_XXX.xlsx
â”‚   â”‚
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ tsconfig.json
â”‚
â”œâ”€â”€ frontend/                        # í”„ë¡ íŠ¸ì—”ë“œ (Next.js 14)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ app/                     # Next.js App Router
â”‚   â”‚   â”‚   â”œâ”€â”€ login/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx         # ë¡œê·¸ì¸ í˜ì´ì§€
â”‚   â”‚   â”‚   â”œâ”€â”€ dashboard/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx         # ëŒ€ì‹œë³´ë“œ í™ˆ
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ generator/
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx     # ë°ì´í„° ìƒì„±ê¸°
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ users/
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx     # ì‚¬ìš©ì ê´€ë¦¬ (Admin)
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ audit/
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx     # ê°ì‚¬ ë¡œê·¸ (Admin)
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ settings/
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ page.tsx     # ì„¤ì •
â”‚   â”‚   â”‚   â”œâ”€â”€ layout.tsx           # ê³µí†µ ë ˆì´ì•„ì›ƒ
â”‚   â”‚   â”‚   â””â”€â”€ globals.css
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ components/              # React ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”‚   â”œâ”€â”€ layout/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Header.tsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ Sidebar.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ dashboard/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ FileManager.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ QuickLaunch.tsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ SystemStatus.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ settings/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ AISettings.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ TESettings.tsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ FileRetention.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ FileUploadZone.tsx
â”‚   â”‚   â”‚   â””â”€â”€ LanguageSwitcher.tsx
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ contexts/                # React Context
â”‚   â”‚   â”‚   â”œâ”€â”€ AuthContext.tsx      # ì¸ì¦ ìƒíƒœ ê´€ë¦¬
â”‚   â”‚   â”‚   â”œâ”€â”€ LanguageContext.tsx  # ë‹¤êµ­ì–´
â”‚   â”‚   â”‚   â””â”€â”€ ThemeContext.tsx     # í…Œë§ˆ
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ i18n/                    # ë‹¤êµ­ì–´ ì§€ì›
â”‚   â”‚       â””â”€â”€ locales/
â”‚   â”‚           â”œâ”€â”€ ko.ts            # í•œêµ­ì–´
â”‚   â”‚           â”œâ”€â”€ en.ts            # English
â”‚   â”‚           â””â”€â”€ zh.ts            # ä¸­æ–‡
â”‚   â”‚
â”‚   â”œâ”€â”€ next.config.mjs              # Next.js ì„¤ì •
â”‚   â”œâ”€â”€ tailwind.config.ts           # Tailwind CSS ì„¤ì •
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ tsconfig.json
â”‚
â”œâ”€â”€ uploads/                         # ì—…ë¡œë“œëœ Excel ì„ì‹œ ì €ì¥
â”‚   â””â”€â”€ {timestamp}_{filename}.xlsx
â”‚
â”œâ”€â”€ logbus 2/                        # LogBus2 ë°”ì´ë„ˆë¦¬
â”‚   â”œâ”€â”€ logbus                       # ì‹¤í–‰ íŒŒì¼
â”‚   â”œâ”€â”€ conf/
â”‚   â”‚   â””â”€â”€ daemon.json              # ëŸ°íƒ€ì„ ìƒì„± (controller.ts)
â”‚   â”œâ”€â”€ log/
â”‚   â”‚   â”œâ”€â”€ transporter.log          # ì „ì†¡ ë¡œê·¸
â”‚   â”‚   â””â”€â”€ daemon.log               # ë°ëª¬ ë¡œê·¸
â”‚   â””â”€â”€ runtime/
â”‚       â””â”€â”€ meta/                    # ë©”íƒ€ë°ì´í„°
â”‚
â”œâ”€â”€ .env                             # í™˜ê²½ ë³€ìˆ˜
â”‚   # Database
â”‚   DATABASE_URL=postgresql://user:password@localhost:5432/te_platform
â”‚
â”‚   # JWT
â”‚   JWT_SECRET=your-super-secret-key
â”‚
â”‚   # AI Provider ì„¤ì •
â”‚   ANTHROPIC_API_KEY=sk-ant-...
â”‚   OPENAI_API_KEY=sk-...
â”‚   GEMINI_API_KEY=...
â”‚   EXCEL_AI_PROVIDER=anthropic     # Excel ìƒì„±ìš© AI
â”‚   DATA_AI_PROVIDER=anthropic      # ë°ì´í„° ìƒì„±ìš© AI
â”‚   DATA_AI_MODEL=claude-3-5-sonnet-20241022
â”‚   VALIDATION_MODEL_TIER=fast      # fast | balanced
â”‚   CUSTOM_VALIDATION_MODEL=        # ì‚¬ìš©ì ì§€ì • ëª¨ë¸
â”‚
â”‚   # ThinkingEngine ì„¤ì •
â”‚   TE_APP_ID=your-app-id
â”‚   TE_RECEIVER_URL=https://te-receiver-naver.thinkingdata.kr/
â”‚
â”‚   # íŒŒì¼ ë³´ê´€ ì„¤ì •
â”‚   DATA_RETENTION_DAYS=7
â”‚   EXCEL_RETENTION_DAYS=30
â”‚   AUTO_DELETE_AFTER_SEND=false
â”‚
â”‚   # Server
â”‚   API_PORT=3001
â”‚
â”œâ”€â”€ docker-compose.yml               # Docker Compose ì„¤ì •
â”œâ”€â”€ DEVELOPMENT_GUIDE.md             # ê°œë°œ ê°€ì´ë“œ
â””â”€â”€ package.json                     # ë£¨íŠ¸ ìŠ¤í¬ë¦½íŠ¸
    # npm run api      â†’ ë°±ì—”ë“œ API ì„œë²„ (3001)
    # npm run frontend â†’ í”„ë¡ íŠ¸ì—”ë“œ ì„œë²„ (3000)
    # npm run db:migrate â†’ ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜
```

### ì£¼ìš” ë””ë ‰í† ë¦¬ ì—­í• 

#### `/excel-schema-generator/`
- **`src/`**: Excel í…ì†Œë…¸ë¯¸ ìƒì„± ë¡œì§
  - `schema-generator.ts`: ë©”ì¸ ìƒì„±ê¸°
  - `taxonomy-builder-v2.ts`: 3-stage AI í”„ë¡œì„¸ìŠ¤
- **`prompts/`**: AI í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ (Stage 1/2/3)
- **`output/generated-schemas/`**: AI ìƒì„± Excel ì €ì¥
  - ë‹¤ìš´ë¡œë“œ ë° ì¬ì‚¬ìš© ê°€ëŠ¥
  - íŒŒì¼ëª… íŒ¨í„´: `{industry}_taxonomy.xlsx`

#### `/data-generator/output/`
- **`runs/`**: ì‹¤í–‰ ë©”íƒ€ë°ì´í„° (í”„ë¡ íŠ¸ì—”ë“œ í‘œì‹œìš©)
  - `metadata.json`: ì‹¤í–‰ ì„¤ì •, AI Provider, ë‚ ì§œ ë²”ìœ„ ë“±
  - `summary.json`: í†µê³„ ìš”ì•½ (ì´ ì´ë²¤íŠ¸, ìœ ì € ìˆ˜ ë“±)
  - `schema.xlsx`: ì‚¬ìš©ëœ Excel ìŠ¤í‚¤ë§ˆ ë°±ì—…
- **`data/`**: ìˆœìˆ˜ JSONL ë°ì´í„° (LogBus2 ì „ì†¡ìš©)
  - ë‚ ì§œë³„ íŒŒì¼: `YYYY-MM-DD.jsonl`
  - LogBus2ë§Œ ì½ìŒ (metadata ì œì™¸)

#### `/uploads/`
- ì‚¬ìš©ìê°€ ì—…ë¡œë“œí•œ Excel ì„ì‹œ ì €ì¥ì†Œ
- Multerë¡œ ì €ì¥ í›„ íŒŒì‹±
- íŒŒì¼ëª… íŒ¨í„´: `{timestamp}_{originalname}.xlsx`

#### `/logbus 2/`
- **`logbus`**: LogBus2 ì‹¤í–‰ ë°”ì´ë„ˆë¦¬
- **`conf/daemon.json`**: ëŸ°íƒ€ì„ ìë™ ìƒì„±
  - LogBus2Controllerê°€ ìƒì„±
  - appId, receiverUrl, gzip ì„¤ì • í¬í•¨

## ì‹œìŠ¤í…œ í†µí•© ë° ë°ì´í„° íë¦„

### ì „ì²´ ë°ì´í„° íŒŒì´í”„ë¼ì¸

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [1ë‹¨ê³„] í”„ë¡ íŠ¸ì—”ë“œ (localhost:3000)                       â”‚
â”‚  - ì‚¬ìš©ì ì…ë ¥ ìˆ˜ì§‘                                        â”‚
â”‚  - UI ìƒíƒœ ê´€ë¦¬ (React State)                              â”‚
â”‚  - 2ì´ˆë§ˆë‹¤ ì§„í–‰ ìƒíƒœ í´ë§                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â”‚ HTTP Request (í”„ë¡ì‹œ: 3000 â†’ 3001)
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [2ë‹¨ê³„] API ì„œë²„ (localhost:3001)                         â”‚
â”‚  - Express REST API                                        â”‚
â”‚  - ë©€í‹°íŒŒíŠ¸ íŒŒì¼ ì—…ë¡œë“œ (Multer)                          â”‚
â”‚  - ì§„í–‰ ìƒíƒœ ì €ì¥ (Map<runId, Progress>)                  â”‚
â”‚  - ì„¤ì • ê´€ë¦¬ (.env íŒŒì¼)                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â”‚ Direct function call
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [3ë‹¨ê³„] ë°ì´í„° ìƒì„± ì—”ì§„                                  â”‚
â”‚  - Excel íŒŒì‹± â†’ ìŠ¤í‚¤ë§ˆ ê°ì²´                               â”‚
â”‚  - AI í˜¸ì¶œ (Claude) â†’ ì´ë²¤íŠ¸ ì˜ì¡´ì„± + ë°ì´í„° ë²”ìœ„        â”‚
â”‚  - ìœ ì € ì½”í˜¸íŠ¸ ìƒì„± â†’ ì„¸ê·¸ë¨¼íŠ¸ë³„ ìœ ì € í’€                  â”‚
â”‚  - ì¼ìë³„ ì´ë²¤íŠ¸ ìƒì„± â†’ JSONL íŒŒì¼ ì €ì¥                   â”‚
â”‚  - ì§„í–‰ ìƒíƒœ ì½œë°± â†’ API ì„œë²„ â†’ í”„ë¡ íŠ¸ì—”ë“œ                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â”‚ File system (JSONL íŒŒì¼)
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [4ë‹¨ê³„] LogBus2 í†µí•©                                       â”‚
â”‚  - daemon.json ìë™ ìƒì„± (gzip ì••ì¶•)                       â”‚
â”‚  - LogBus2 í”„ë¡œì„¸ìŠ¤ ì‹œì‘ (exec)                           â”‚
â”‚  - íŒŒì¼ ì—…ë¡œë“œ ëª¨ë‹ˆí„°ë§ (progress ëª…ë ¹)                   â”‚
â”‚  - ì „ì†¡ ì™„ë£Œ í›„ LogBus2 ì¢…ë£Œ                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â”‚ HTTPS POST (gzip compressed)
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [5ë‹¨ê³„] ThinkingEngine                                    â”‚
â”‚  - ì´ë²¤íŠ¸ ìˆ˜ì‹  ë° ì €ì¥                                     â”‚
â”‚  - ë°ì´í„° ë¶„ì„ ëŒ€ì‹œë³´ë“œ                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### API í˜¸ì¶œ ì‹œí€€ìŠ¤

#### ìƒˆë¡œ ë§Œë“¤ê¸° ëª¨ë“œ

```
í”„ë¡ íŠ¸ì—”ë“œ                API ì„œë²„                  Excel ìƒì„±ê¸°/ë°ì´í„° ì—”ì§„
    â”‚
    â”‚ GET /api/settings
    â”‚ (ì´ˆê¸° ì„¤ì • ë¡œë“œ: AI Provider, API Keys)
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    â”‚ {ANTHROPIC_API_KEY, OPENAI_API_KEY, EXCEL_AI_PROVIDER, DATA_AI_PROVIDER...}
    â”‚
    â”‚ [ì‚¬ìš©ì: ì‹œë‚˜ë¦¬ì˜¤, ì‚°ì—…, íŠ¹ì§• ì…ë ¥]
    â”‚
    â”‚ ğŸ“Š Excel ìƒì„± ì‹œì‘
    â”‚ POST /api/excel/generate
    â”‚ {scenario, industry, notes}
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>
    â”‚                     ExcelSchemaGenerator í˜¸ì¶œ
    â”‚                     â”‚
    â”‚                     â”‚ TaxonomyBuilderV2
    â”‚                     â”‚   Stage 1: ì´ë²¤íŠ¸/ì†ì„± ì„¤ê³„ (Claude/GPT)
    â”‚                     â”‚   Stage 2: ë°ì´í„° êµ¬ì¡° ìµœì í™”
    â”‚                     â”‚   Stage 3: 4-sheet Excel ìƒì„±
    â”‚                     â”‚
    â”‚                     â”‚ output/generated-schemas/XXX.xlsx
    â”‚                     â”‚ ExcelParserë¡œ íŒŒì‹± â†’ ë¯¸ë¦¬ë³´ê¸° ìƒì„±
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    â”‚ {file: {path, name}, preview: {events, properties...}}
    â”‚
    â”‚ [Excel ë¯¸ë¦¬ë³´ê¸° í‘œì‹œ]
    â”‚
    â”‚ [Excel ë‹¤ìš´ë¡œë“œ (ì˜µì…˜)]
    â”‚ GET /api/excel/download/:filename
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>
    â”‚                     res.download()
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    â”‚
    â”‚ [ì‚¬ìš©ì: DAU, ë‚ ì§œ ë²”ìœ„ ì…ë ¥]
    â”‚
    â”‚ ğŸ¤– ë°ì´í„° ìƒì„± ì‹œì‘
    â”‚ POST /api/generate/start
    â”‚ {excelPath, scenario, dau, industry, notes, dateStart, dateEnd, aiProvider}
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>
    â”‚                     runId ìƒì„±
    â”‚                     progressMap.set(runId, {status: 'starting'...})
    â”‚
    â”‚                     generateDataAsync(runId, config) ë¹„ë™ê¸° ì‹¤í–‰
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    â”‚ {runId, statusUrl}
    â”‚
    â”‚ [2ì´ˆë§ˆë‹¤ í´ë§ ì‹œì‘]
    â”‚ GET /api/generate/status/:runId
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>
    â”‚                     progressMap.get(runId)
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    â”‚ {status, progress: 45%, message: "ìœ ì € ì½”í˜¸íŠ¸ ìƒì„± ì¤‘..."}
    â”‚
    â”‚                     DataGenerator.generate()
    â”‚                     â”‚ onProgress ì½œë°±ìœ¼ë¡œ progressMap ì—…ë°ì´íŠ¸
    â”‚                     â”‚ - Excel íŒŒì‹± (10%)
    â”‚                     â”‚ - AI ë¶„ì„ (30%)
    â”‚                     â”‚ - ìœ ì € ìƒì„± (50%)
    â”‚                     â”‚ - ì´ë²¤íŠ¸ ìƒì„± (70-95%)
    â”‚                     â”‚ - JSONL ì €ì¥ (100%)
    â”‚
    â”‚ [í´ë§ ê³„ì†...]
    â”‚ GET /api/generate/status/:runId
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    â”‚ {status: 'completed', progress: 100, result: {totalEvents, totalUsers, runId}}
    â”‚
    â”‚ [ìƒì„± ì™„ë£Œ í™”ë©´ í‘œì‹œ]
    â”‚ - ì´ ì´ë²¤íŠ¸, ì´ ì‚¬ìš©ì, Run ID
    â”‚
    â”‚ [ì‚¬ìš©ì: APP_ID ì…ë ¥]
    â”‚
    â”‚ ğŸ“¤ ì „ì†¡ ì‹œì‘
    â”‚ POST /api/send-data/:runId
    â”‚ {appId}
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>
    â”‚                     sendDataAsync(runId, appId) ë¹„ë™ê¸° ì‹¤í–‰
    â”‚                     â”‚
    â”‚                     â”‚ LogBus2Controller
    â”‚                     â”‚   - daemon.json ìƒì„± (appId, gzip ì„¤ì •)
    â”‚                     â”‚   - logbus start
    â”‚                     â”‚   - monitorProgress (3ì´ˆ í´ë§)
    â”‚                     â”‚     progressMap ì—…ë°ì´íŠ¸
    â”‚                     â”‚   - logbus stop
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    â”‚ {success: true, statusUrl}
    â”‚
    â”‚ [í´ë§ìœ¼ë¡œ ì „ì†¡ ì§„í–‰ë¥  í‘œì‹œ]
    â”‚ GET /api/generate/status/:runId
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    â”‚ {status: 'sending', progress: 75%, message: "ì „ì†¡ ì¤‘: 22/30 íŒŒì¼"}
    â”‚
    â”‚ [ì „ì†¡ ì™„ë£Œ]
    â”‚ GET /api/generate/status/:runId
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    â”‚ {status: 'sent', progress: 100, sentInfo: {appId, fileSizeMB, receiverUrl}}
    â”‚
    â”‚ [íŒŒì¼ ì •ë¦¬ (ìë™, ì„¤ì •ì— ë”°ë¼)]
    â”‚                     FileRetentionManager
    â”‚                     - AUTO_DELETE_AFTER_SEND=true â†’ ì¦‰ì‹œ ì‚­ì œ
    â”‚                     - ë˜ëŠ” DATA_RETENTION_DAYS ê¸°ê°„ í›„ ì‚­ì œ
```

#### ê¸°ì¡´ ì—‘ì…€ ì‚¬ìš© ëª¨ë“œ

```
í”„ë¡ íŠ¸ì—”ë“œ                API ì„œë²„
    â”‚
    â”‚ ğŸ“ íŒŒì¼ ì„ íƒ (ë“œë˜ê·¸ ì•¤ ë“œë¡­)
    â”‚
    â”‚ POST /api/excel/upload
    â”‚ multipart/form-data
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>
    â”‚                     Multer: uploads/ ë””ë ‰í† ë¦¬ì— ì €ì¥
    â”‚                     ExcelParser.parseExcelFile(path)
    â”‚                     â”‚ - 4-sheet íŒŒì‹±
    â”‚                     â”‚ - ParsedSchema ê°ì²´ ìƒì„±
    â”‚                     â”‚ - ë¯¸ë¦¬ë³´ê¸° ë°ì´í„° ì¶”ì¶œ
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    â”‚ {file: {path, name, size}, preview: {events, eventProperties, commonProperties, userData}}
    â”‚
    â”‚ [ì—…ë¡œë“œ ì™„ë£Œ í™”ë©´]
    â”‚ - ì´ë²¤íŠ¸ ìˆ˜, ì´ë²¤íŠ¸ ì†ì„± ìˆ˜, ê³µí†µ ì†ì„± ìˆ˜, ìœ ì € ë°ì´í„° ìˆ˜ í‘œì‹œ
    â”‚
    â”‚ [ì‚¬ìš©ì: ì‹œë‚˜ë¦¬ì˜¤, DAU, ì‚°ì—…, ì„œë¹„ìŠ¤ íŠ¹ì§•, ë‚ ì§œ ë²”ìœ„ ì…ë ¥]
    â”‚
    â”‚ ğŸ¤– ë°ì´í„° ìƒì„± ì‹œì‘
    â”‚ POST /api/generate/start
    â”‚ {excelPath=uploaded, scenario, dau, industry, notes, dateStart, dateEnd, aiProvider}
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>
    â”‚
    â”‚ (ì´í›„ ìƒˆë¡œ ë§Œë“¤ê¸° ëª¨ë“œì™€ ë™ì¼)
    â”‚ - runId ë°˜í™˜ â†’ í´ë§ â†’ ìƒì„± ì™„ë£Œ â†’ ì „ì†¡
```

## ë°ì´í„° ìƒì„± íë¦„ ìƒì„¸

### Phase 1: Excel íŒŒì¼ ì½ê¸° (í”„ë¡ íŠ¸ì—”ë“œ)
```
ì™¸ë¶€ í”„ë¡œê·¸ë¨ì´ ìƒì„±í•œ Excel íŒŒì¼
  â†“ (excel-schema-generator/output/ ì—ì„œ íŒŒì¼ ì„ íƒ)
  â†“
Excel íŒŒì¼ ì½ê¸° (xlsx ë¼ì´ë¸ŒëŸ¬ë¦¬)
  â†“
ParsedSchema {
  events: [{name: "app_start", category: "system", ...}, ...],
  properties: [{name: "stage_id", type: "string", ...}, ...],
  userSegments: [{name: "whale", percentage: 5, ...}, ...],
  funnels: [{name: "onboarding", events: [...], ...}, ...],
  dependencies: null  // ì•„ì§ AIê°€ ì¶”ë¡ í•˜ì§€ ì•ŠìŒ
}
```

### Phase 2: AI ë¶„ì„ ë° ë²”ìœ„ ìƒì„± (ì„œë²„ API)
```
AI ì…ë ¥ {
  // Excelì—ì„œ ì½ì€ ì •ë³´
  events: ["app_start", "tutorial_start", "purchase_complete", ...],
  properties: {
    "product_id": { type: "string", examples: ["prod_001", "prod_002"] },
    "amount": { type: "number", examples: [1000, 5000, 10000] },
    "user_name": { type: "string", examples: [] },  // Faker.jsë¡œ ìƒì„±
    "address": { type: "string", examples: [] }      // Faker.jsë¡œ ìƒì„±
  },

  // í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ì…ë ¥ë°›ì€ ì •ë³´
  userInputs: {
    scenario: "ì‹ ê·œ ìœ ì € ì˜¨ë³´ë”©ì— ì§‘ì¤‘í•˜ê³ , ì²« ê²°ì œê¹Œì§€ì˜ í¼ë„ì„ ìµœì í™”í•˜ê³  ì‹¶ìŠµë‹ˆë‹¤...",
    dau: 1000,
    industry: "ì»¤ë¨¸ìŠ¤",
    notes: "ì¼ë³¸ íƒ€ê²Ÿ ì´ì»¤ë¨¸ìŠ¤, íŒ¨ì…˜/ë·°í‹° ì¤‘ì‹¬",
    dateRange: { start: "2025-01-01", end: "2025-01-30" }
  }
}

**ì¤‘ìš”**: AIëŠ” ë‹¤ìŒì„ ì¸ì‹:
- user_name, address ë“±ì€ Faker.jsê°€ êµ­ê°€ë³„ ë¡œì¼€ì¼ë¡œ ìë™ ìƒì„±
- AIëŠ” product_id, amount ë“± ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì¤‘ì‹¬ ë²”ìœ„ë§Œ ì •ì˜
- êµ­ê°€ ì„¤ì •(ì¼ë³¸)ì— ë”°ë¼ Faker.jsê°€ ì¼ë³¸ì–´ ì´ë¦„, ì¼ë³¸ ì£¼ì†Œ ìƒì„±
  â†“ (Claude/OpenAI API í˜¸ì¶œ)
  â†“
AI ì¶œë ¥ {
  // 1. ìœ ì € ì„¸ê·¸ë¨¼íŠ¸ ë¹„ìœ¨ ìë™ ê²°ì •
  userSegments: {
    new: { ratio: 0.10, description: "ì‹ ê·œ ìœ ì €" },
    core: { ratio: 0.15, description: "í•µì‹¬ ìœ ì € (ê³ ê³¼ê¸ˆ, ê³ ì°¸ì—¬)" },
    regular: { ratio: 0.50, description: "ì¼ë°˜ ìœ ì €" },
    light: { ratio: 0.25, description: "ë¼ì´íŠ¸ ìœ ì € (ì €ì°¸ì—¬)" }
  },

  // 2. ì´ë²¤íŠ¸ ì˜ì¡´ì„± ì¶”ë¡ 
  dependencies: {
    "app_start": [],
    "tutorial_start": ["app_start"],
    "tutorial_complete": ["tutorial_start"],
    "stage_1_start": ["tutorial_complete"],
    "stage_1_clear": ["stage_1_start"],
    "iap_purchase": ["tutorial_complete"]  // ì„ íƒì 
  },

  // 3. ì„¸ê·¸ë¨¼íŠ¸ë³„ ë°ì´í„° ë²”ìœ„ ìƒì„±
  dataRanges: {
    "stage_clear": {
      "stage_id": {
        "core": { values: ["s5-1", "s5-2", ... "s10-20"], weights: [...] },
        "regular": { values: ["s2-1", ... "s5-20"], weights: [...] },
        "light": { values: ["s1-1", ... "s3-10"], weights: [...] }
      },
      "rewards_gold": {
        "core": { min: 500, max: 5000, distribution: "normal" },
        "regular": { min: 100, max: 1000, distribution: "normal" },
        "light": { min: 50, max: 500, distribution: "normal" }
      }
    }
  },

  // 4. í˜„ì‹¤ì ì¸ ì‹œê°„ ê°„ê²© ì •ì˜
  timingPatterns: {
    "tutorial_start â†’ tutorial_complete": { min: 120, max: 300, unit: "seconds" },
    "app_start â†’ first_event": { min: 2, max: 10, unit: "seconds" },
    "stage_start â†’ stage_clear": { min: 30, max: 180, unit: "seconds" }
  },

  // 5. ì„¸ì…˜ íŒ¨í„´ ì •ì˜
  sessionPatterns: {
    "new": { avgSessionsPerDay: 3, avgDuration: 30, peakHours: [12, 20, 22] },
    "core": { avgSessionsPerDay: 5, avgDuration: 45, peakHours: [9, 12, 18, 21] },
    "regular": { avgSessionsPerDay: 2, avgDuration: 20, peakHours: [12, 20] },
    "light": { avgSessionsPerDay: 0.5, avgDuration: 10, peakHours: [21] }
  }
}
```

### Phase 3: ìœ ì € ì½”í˜¸íŠ¸ ìƒì„± (í”„ë¡ íŠ¸ì—”ë“œ)
```
AI ê²°ì • ì„¸ê·¸ë¨¼íŠ¸ ë¹„ìœ¨:
  ì‹ ê·œ 10%, í•µì‹¬ 15%, ì¼ë°˜ 50%, ë¼ì´íŠ¸ 25%

DAU: 1,000ëª…
ë‚ ì§œ ë²”ìœ„: 2025-01-01 ~ 2025-01-30

  â†“ (AI ë¹„ìœ¨ì— ë”°ë¼ ìœ ì € ìƒì„±)
  â†“
ì´ ìœ ì € í’€ ìƒì„± (ì„¤ì¹˜ì¼ ë¶„ì‚°):
  ì‹ ê·œ: 153ëª… (30ì¼ê°„ ë¶„ì‚° ì„¤ì¹˜)
  í•µì‹¬: 230ëª…
  ì¼ë°˜: 766ëª…
  ë¼ì´íŠ¸: 383ëª…

  â†“ (ë‚ ì§œë³„ í™œì„± ìœ ì € ë°°ì¹˜)
  â†“
Map<Date, User[]> {
  "2025-01-01": [
    { id: "user_0001", installDate: "2025-01-01", segment: "new", stage: "new", ... },
    { id: "user_0002", installDate: "2024-12-20", segment: "core", stage: "active", ... },
    { id: "user_0003", installDate: "2024-12-15", segment: "regular", stage: "returning", ... },
    ...
    (ì´ 1,000ëª…: DAU ìœ ì§€, ì„¸ê·¸ë¨¼íŠ¸ë³„ í™œë™ íŒ¨í„´ ì ìš©)
  ],
  "2025-01-02": [
    { id: "user_0005", installDate: "2025-01-02", segment: "new", stage: "new", ... },
    { id: "user_0001", installDate: "2025-01-01", segment: "new", stage: "active", ... },
    ...
    (ì´ 1,000ëª…)
  ],
  ...
}
```

### Phase 4: ì¼ìë³„ ì´ë²¤íŠ¸ ìƒì„± (í”„ë¡ íŠ¸ì—”ë“œ)
```
FOR EACH ë‚ ì§œ in ë²”ìœ„:
  FOR EACH ìœ ì € in cohorts[ë‚ ì§œ]:
    1. ìƒëª…ì£¼ê¸° ë‹¨ê³„ í™•ì¸ (new/active/returning)
    2. ì„¸ì…˜ ìŠ¤ì¼€ì¤„ ìƒì„± (í•˜ë£¨ ì¤‘ ëª‡ ë²ˆ ì ‘ì†)

    FOR EACH ì„¸ì…˜:
      3. app_start ì´ë²¤íŠ¸
      4. ì‹ ê·œ ìœ ì € â†’ ì˜¨ë³´ë”© í¼ë„ (ì˜ì¡´ì„± ì²´í¬)
      5. ì„œë¹„ìŠ¤ ì´ë²¤íŠ¸ ìƒì„± (ê°€ëŠ¥í•œ ì´ë²¤íŠ¸ë§Œ)
      6. app_end ì´ë²¤íŠ¸
      7. TE í˜•ì‹ìœ¼ë¡œ ë³€í™˜
      8. user_set/user_add ìƒì„±

  9. í•´ë‹¹ ë‚ ì§œ ì´ë²¤íŠ¸ ì‹œê°„ìˆœ ì •ë ¬
  10. JSONL íŒŒì¼ ì €ì¥: output/run_XXX/YYYY-MM-DD.jsonl
```

### Phase 5: íŒŒì¼ ì‘ì„± ì˜ˆì‹œ
```javascript
// output/data/run_20250105_143022/2025-01-01.jsonl (LogBus2ê°€ ì½ìŒ)
{"#type":"track","#event_name":"app_start","#account_id":"user_0001","#event_time":"2025-01-01 09:15:23.123",...}
{"#type":"track","#event_name":"sign_up","#account_id":"user_0001","#event_time":"2025-01-01 09:15:45.456",...}
{"#type":"user_set","#account_id":"user_0001","#event_time":"2025-01-01 09:15:45.456","properties":{"user_type":"new"}}
{"#type":"track","#event_name":"tutorial_start","#account_id":"user_0001","#event_time":"2025-01-01 09:16:12.789",...}
...

// output/runs/run_20250105_143022/metadata.json (ë©”íƒ€ë°ì´í„°)
{
  "runId": "run_20250105_143022",
  "createdAt": "2025-01-05T14:30:22Z",
  "config": {...},
  "aiGenerated": {
    "dependencies": {...},
    "dataRanges": {...}
  }
}

// output/runs/run_20250105_143022/summary.json (í†µê³„)
{
  "totalEvents": 150420,
  "eventsByDate": {...},
  "funnelConversions": {...}
}

// output/runs/run_20250105_143022/schema.xlsx (ì‚¬ìš©ëœ ìŠ¤í‚¤ë§ˆ ë°±ì—…)
```

## í•µì‹¬ ì•Œê³ ë¦¬ì¦˜

### 1. ì´ë²¤íŠ¸ ì˜ì¡´ì„± ê²€ì¦
```typescript
class DependencyManager {
  canFireEvent(eventName: string, user: User): boolean {
    const deps = this.dependencies.get(eventName) || [];

    // ëª¨ë“  í•„ìˆ˜ ì„ í–‰ ì´ë²¤íŠ¸ ì™„ë£Œ í™•ì¸
    for (const requiredEvent of deps) {
      if (!user.completedEvents.has(requiredEvent)) {
        return false;
      }
    }

    // ë™ì‹œ ë°œìƒ ë¶ˆê°€ ì´ë²¤íŠ¸ í™•ì¸
    const conflicts = this.conflicts.get(eventName) || [];
    for (const conflict of conflicts) {
      if (user.completedEvents.has(conflict)) {
        return false;
      }
    }

    return true;
  }
}
```

### 2. í˜„ì‹¤ì ì¸ ì„¸ì…˜ ìƒì„±
```typescript
function generateSessionsForDay(
  user: User,
  date: Date,
  segment: UserSegment
): Session[] {
  const sessions: Session[] = [];
  const sessionCount = poissonRandom(segment.avg_sessions_per_day);

  for (let i = 0; i < sessionCount; i++) {
    // ìœ ì € íƒ€ì…ë³„ ì„ í˜¸ ì‹œê°„ëŒ€
    const preferredHours = {
      whale: [9, 12, 18, 21],      // ì•„ì¹¨, ì ì‹¬, ì €ë…, ë°¤
      regular: [12, 20],            // ì ì‹¬, ì €ë…
      casual: [21]                  // ë°¤ì—ë§Œ
    }[user.segment];

    const hour = weightedRandom(preferredHours);
    const minute = randomInt(0, 59);

    const start = new Date(date);
    start.setHours(hour, minute, randomInt(0, 59));

    const duration = normalRandom(
      segment.avg_session_duration_min,
      segment.avg_session_duration_min * 0.3 // í‘œì¤€í¸ì°¨ 30%
    );

    sessions.push({
      start,
      duration,
      end: new Date(start.getTime() + duration * 60 * 1000)
    });
  }

  return sessions.sort((a, b) => a.start.getTime() - b.start.getTime());
}
```

### 3. ìœ ì € ìƒëª…ì£¼ê¸° ê²°ì •
```typescript
function determineLifecycleStage(user: User, currentDate: Date): LifecycleStage {
  const daysSinceInstall = daysBetween(user.installDate, currentDate);
  const daysSinceLastActive = daysBetween(user.lastActiveDate, currentDate);

  if (daysSinceInstall === 0) {
    return 'new';  // ì„¤ì¹˜ ë‹¹ì¼
  }

  if (daysSinceLastActive === 1) {
    return 'active';  // ë§¤ì¼ ì ‘ì†
  }

  if (daysSinceLastActive >= 2 && daysSinceLastActive <= 7) {
    return 'returning';  // ë©°ì¹ ë§Œì— ë³µê·€
  }

  if (daysSinceLastActive >= 8 && daysSinceLastActive <= 30) {
    return 'dormant';  // íœ´ë©´
  }

  return 'churned';  // ì´íƒˆ
}
```

## ì„±ëŠ¥ ê³ ë ¤ì‚¬í•­

### ìµœì í™” ëª©í‘œ
- **1,000 DAU x 30ì¼**: 10ì´ˆ ì´ë‚´ ìƒì„±
- **10,000 DAU x 30ì¼**: 60ì´ˆ ì´ë‚´ ìƒì„±
- **ë©”ëª¨ë¦¬**: 100,000 ì´ë²¤íŠ¸ë‹¹ 100MB ì´í•˜

### ìµœì í™” ì „ëµ
1. **ë‚ ì§œë³„ ì²­í¬ ì²˜ë¦¬**: í•œ ë²ˆì— ëª¨ë“  ë‚ ì§œ ìƒì„±í•˜ì§€ ì•Šê³  í•˜ë£¨ì”©
2. **Web Worker ì‚¬ìš©**: ë³‘ë ¬ë¡œ ì—¬ëŸ¬ ë‚ ì§œ ë™ì‹œ ìƒì„±
3. **ìŠ¤íŠ¸ë¦¬ë° íŒŒì¼ ì‘ì„±**: ë©”ëª¨ë¦¬ì— ëª¨ë‘ ì €ì¥í•˜ì§€ ì•Šê³  ì¦‰ì‹œ íŒŒì¼ ì‘ì„±
4. **AI ë²”ìœ„ ìºì‹±**: ë™ì¼ ìŠ¤í‚¤ë§ˆì— ëŒ€í•´ ì¬ì‚¬ìš©

## ê²€ì¦ ì²´í¬ë¦¬ìŠ¤íŠ¸

ìƒì„±ëœ ë°ì´í„°ê°€ í˜„ì‹¤ì ì¸ì§€ í™•ì¸:

### âœ… ì´ë²¤íŠ¸ ìˆœì„œ
- [ ] app_install â†’ app_start â†’ sign_up â†’ login ìˆœì„œ ë³´ì¥
- [ ] tutorial_start ì „ì— sign_up ì™„ë£Œ
- [ ] stage_N_clear ì „ì— stage_N_start ë°œìƒ
- [ ] ëª¨ë“  ì„¸ì…˜ì´ app_startë¡œ ì‹œì‘, app_endë¡œ ì¢…ë£Œ

### âœ… ìœ ì € ìƒëª…ì£¼ê¸°
- [ ] ì‹ ê·œ ìœ ì €ëŠ” ì²«ë‚  ì˜¨ë³´ë”© í¼ë„ ì§„í–‰
- [ ] ì‹ ê·œ ìœ ì € ë¹„ìœ¨ì´ ì„¤ì •ê°’ê³¼ ì¼ì¹˜ (Â±5%)
- [ ] D1, D7, D30 ë¦¬í…ì…˜ì´ ì •ì˜ëœ ë²”ìœ„ ë‚´

### âœ… ì‹œê°„ ë¶„í¬
- [ ] ì´ë²¤íŠ¸ê°€ ë‚ ì§œë³„ë¡œ ê· ë“± ë¶„ì‚°
- [ ] ì„¸ì…˜ì´ í˜„ì‹¤ì ì¸ ì‹œê°„ëŒ€ì— ë°œìƒ
- [ ] ì„¸ì…˜ ê°„ ê°„ê²©ì´ ìì—°ìŠ¤ëŸ¬ì›€

### âœ… ë°ì´í„° í’ˆì§ˆ
- [ ] ëª¨ë“  í•„ìˆ˜ ì‹œìŠ¤í…œ í•„ë“œ ì¡´ì¬
- [ ] ì´ë²¤íŠ¸ ì‹œê°„ì´ ì‹œë®¬ë ˆì´ì…˜ ë²”ìœ„ ë‚´
- [ ] ì†ì„± ê°’ì´ ì •ì˜ëœ ë°ì´í„° íƒ€ì…ê³¼ ì¼ì¹˜
- [ ] JSONL íŒŒì¼ í˜•ì‹ ìœ íš¨

## ì°¸ê³  ìë£Œ

- **ThinkingEngine ë¬¸ì„œ**: `docs/ThinkingEngine.md`
- **LogBus2 ê°€ì´ë“œ**: `docs/logbus2.md`
- **í”„ë¦¬ì…‹ ì†ì„±**: `docs/Preset Properties.md`
